/**** v6.1.34, build: 04/29/2019 ****/
function ConvexHullGrahamScan(){this.anchorPoint=void 0;this.reverse=!1;this.points=[]}!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this;e.rbush=t()}}(function(){return function t(e,i,n){function r(s,l){if(!i[s]){if(!e[s]){var p="function"==typeof require&&require;if(!l&&p)return p(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var a=i[s]={exports:{}};e[s][0].call(a.exports,function(t){var i=e[s][1][t];return r(i||t)},a,a.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this._maxEntries=Math.max(4,t||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));e&&this._initFormat(e);this.clear()}function r(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,r){r||(r=m(null));r.minX=1/0;r.minY=1/0;r.maxX=-1/0;r.maxY=-1/0;for(var o,s=e;s<i;s++){o=t.children[s];l(r,t.leaf?n(o):o)}return r}function l(t,e){t.minX=Math.min(t.minX,e.minX);t.minY=Math.min(t.minY,e.minY);t.maxX=Math.max(t.maxX,e.maxX);t.maxY=Math.max(t.maxY,e.maxY);return t}function p(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function a(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function d(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-i)*Math.max(0,o-n)}function y(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function c(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function x(t,e,i,n,r){for(var o,s=[e,i];s.length;){i=s.pop();e=s.pop();if(!(i-e<=n)){o=e+Math.ceil((i-e)/n/2)*n;g(t,o,e,i,r);s.push(e,o,o,i)}}}e.exports=n;e.exports.default=n;var g=t("quickselect");n.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!c(t,e))return i;for(var r,o,s,l,p=[];e;){for(r=0,o=e.children.length;r<o;r++){s=e.children[r];l=e.leaf?n(s):s;c(t,l)&&(e.leaf?i.push(s):y(t,l)?this._all(s,i):p.push(s))}e=p.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!c(t,e))return!1;for(var n,r,o,s,l=[];e;){for(n=0,r=e.children.length;n<r;n++){o=e.children[n];s=e.leaf?i(o):o;if(c(t,s)){if(e.leaf||y(t,s))return!0;l.push(o)}}e=l.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n;n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){t&&this._insert(t,this.data.height-1);return this},clear:function(){this.data=m([]);return this},remove:function(t,e){if(!t)return this;for(var i,n,o,s,l=this.data,p=this.toBBox(t),h=[],a=[];l||h.length;){if(!l){l=h.pop();n=h[h.length-1];i=a.pop();s=!0}if(l.leaf){o=r(t,l.children,e);if(-1!==o){l.children.splice(o,1);h.push(l);this._condense(h);return this}}if(s||l.leaf||!y(l,p))if(n){i++;l=n.children[i];s=!1}else l=null;else{h.push(l);a.push(i);i=0;n=l;l=l.children[0]}}return this},toBBox:function(t){return t},compareMinX:p,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(t){this.data=t;return this},_all:function(t,e){for(var i=[];t;){t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children);t=i.pop()}return e},_build:function(t,e,i,n){var r,s=i-e+1,l=this._maxEntries;if(s<=l){r=m(t.slice(e,i+1));o(r,this.toBBox);return r}if(!n){n=Math.ceil(Math.log(s)/Math.log(l));l=Math.ceil(s/Math.pow(l,n-1))}r=m([]);r.leaf=!1;r.height=n;var p,h,a,u,f=Math.ceil(s/l),d=f*Math.ceil(Math.sqrt(l));x(t,e,i,d,this.compareMinX);for(p=e;p<=i;p+=d){a=Math.min(p+d-1,i);x(t,p,a,f,this.compareMinY);for(h=p;h<=a;h+=f){u=Math.min(h+f-1,a);r.children.push(this._build(t,h,u,n-1))}}o(r,this.toBBox);return r},_chooseSubtree:function(t,e,i,n){for(var r,o,s,l,p,h,u,d;;){n.push(e);if(e.leaf||n.length-1===i)break;u=d=1/0;for(r=0,o=e.children.length;r<o;r++){s=e.children[r];p=a(s);h=f(t,s)-p;if(h<d){d=h;u=p<u?p:u;l=s}else if(h===d&&p<u){u=p;l=s}}e=l||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);s.children.push(t);l(s,r);for(;e>=0&&o[e].children.length>this._maxEntries;){this._split(o,e);e--}this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var s=this._chooseSplitIndex(i,r,n),l=m(i.children.splice(s,i.children.length-s));l.height=i.height;l.leaf=i.leaf;o(i,this.toBBox);o(l,this.toBBox);e?t[e-1].children.push(l):this._splitRoot(i,l)},_splitRoot:function(t,e){this.data=m([t,e]);this.data.height=t.height+1;this.data.leaf=!1;o(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,l,p,h,u,f;h=u=1/0;for(n=e;n<=i-e;n++){r=s(t,0,n,this.toBBox);o=s(t,n,i,this.toBBox);l=d(r,o);p=a(r)+a(o);if(l<h){h=l;f=n;u=p<u?p:u}else if(l===h&&p<u){u=p;f=n}}return f},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:p,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,p=this.toBBox,h=s(t,0,e,p),a=s(t,i-e,i,p),f=u(h)+u(a);for(r=e;r<i-e;r++){o=t.children[r];l(h,t.leaf?p(o):o);f+=u(h)}for(r=i-e-1;r>=e;r--){o=t.children[r];l(a,t.leaf?p(o):o);f+=u(a)}return f},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)l(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)if(0===t[i].children.length)if(i>0){e=t[i-1].children;e.splice(e.indexOf(t[i]),1)}else this.clear();else o(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0]));this.compareMinY=new Function("a","b",e.join(t[1]));this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},{quickselect:2}],2:[function(t,e,i){"use strict";function n(t,e,i,n,o){r(t,e,i||0,n||t.length-1,o||s)}function r(t,e,i,n,s){for(;n>i;){if(n-i>600){var l=n-i+1,p=e-i+1,h=Math.log(l),a=.5*Math.exp(2*h/3),u=.5*Math.sqrt(h*a*(l-a)/l)*(p-l/2<0?-1:1);r(t,e,Math.max(i,Math.floor(e-p*a/l+u)),Math.min(n,Math.floor(e+(l-p)*a/l+u)),s)}var f=t[e],d=i,y=n;o(t,i,e);s(t[n],f)>0&&o(t,i,n);for(;d<y;){o(t,d,y);d++;y--;for(;s(t[d],f)<0;)d++;for(;s(t[y],f)>0;)y--}if(0===s(t[i],f))o(t,i,y);else{y++;o(t,y,n)}y<=e&&(i=y+1);e<=y&&(n=y-1)}}function o(t,e,i){var n=t[e];t[e]=t[i];t[i]=n}function s(t,e){return t<e?-1:t>e?1:0}e.exports=n;e.exports.default=n},{}]},{},[1])(1)});ConvexHullGrahamScan.prototype={constructor:ConvexHullGrahamScan,Point:function(t,e){this.x=t;this.y=e},_findPolarAngle:function(t,e){var i,n;if(!t||!e)return 0;i=e.x-t.x;n=e.y-t.y;if(0===i&&0===n)return 0;var r=57.295779513082*Math.atan2(n,i);this.reverse?r<=0&&(r+=360):r>=0&&(r+=360);return r},addPoint:function(t,e){if(void 0===this.anchorPoint||this.anchorPoint.y>e||this.anchorPoint.y===e&&this.anchorPoint.x>t){void 0!==this.anchorPoint&&this.points.push(new this.Point(this.anchorPoint.x,this.anchorPoint.y));this.anchorPoint=new this.Point(t,e)}else this.points.push(new this.Point(t,e))},_sortPoints:function(){var t=this;return this.points.sort(function(e,i){var n=t._findPolarAngle(t.anchorPoint,e),r=t._findPolarAngle(t.anchorPoint,i);return n<r?-1:n>r?1:0})},_checkPoints:function(t,e,i){var n,r=this._findPolarAngle(t,e),o=this._findPolarAngle(t,i);if(r>o){n=r-o;return n<=180}if(r<o){n=o-r;return n>180}return!0},getHull:function(){var t,e,i=[];this.reverse=this.points.every(function(t){return t.x<0&&t.y<0});t=this._sortPoints();e=t.length;if(e<3){t.unshift(this.anchorPoint);return t}i.push(t.shift(),t.shift());for(;;){var n,r,o;i.push(t.shift());n=i[i.length-3];r=i[i.length-2];o=i[i.length-1];this._checkPoints(n,r,o)&&i.splice(i.length-2,1);if(0===t.length){if(e==i.length){var s=this.anchorPoint;i=i.filter(function(t){return!!t});i.some(function(t){return t.x==s.x&&t.y==s.y})||i.unshift(this.anchorPoint);return i}t=i;e=t.length;i=[];i.push(t.shift(),t.shift())}}}};"function"==typeof define&&define.amd&&define(function(){return ConvexHullGrahamScan});"undefined"!=typeof module&&(module.exports=ConvexHullGrahamScan);!function(){function t(t,e,i){Kt.biginteger_used=1;if(null!=t)if("number"==typeof t)this.fromString(Math.floor(t).toString(),10);else if(null==e&&"string"!=typeof t)this.fromString(t,256);else{-1!=t.indexOf(".")&&(t=t.substring(0,t.indexOf(".")));this.fromString(t,e)}}function e(){return new t(null)}function i(t,e,i,n,r,o){for(;--o>=0;){var s=e*this[t++]+i[n]+r;r=Math.floor(s/67108864);i[n++]=67108863&s}return r}function n(t,e,i,n,r,o){for(var s=32767&e,l=e>>15;--o>=0;){var p=32767&this[t],h=this[t++]>>15,a=l*p+h*s;p=s*p+((32767&a)<<15)+i[n]+(1073741823&r);r=(p>>>30)+(a>>>15)+l*h+(r>>>30);i[n++]=1073741823&p}return r}function r(t,e,i,n,r,o){for(var s=16383&e,l=e>>14;--o>=0;){var p=16383&this[t],h=this[t++]>>14,a=l*p+h*s;p=s*p+((16383&a)<<14)+i[n]+r;r=(p>>28)+(a>>14)+l*h;i[n++]=268435455&p}return r}function o(t){return se.charAt(t)}function s(t,e){var i=le[t.charCodeAt(e)];return null==i?-1:i}function l(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t;t.s=this.s}function p(t){this.t=1;this.s=t<0?-1:0;t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0}function h(t){var i=e();i.fromInt(t);return i}function a(e,i){var n;if(16==i)n=4;else if(8==i)n=3;else if(256==i)n=8;else if(2==i)n=1;else if(32==i)n=5;else{if(4!=i){this.fromRadix(e,i);return}n=2}this.t=0;this.s=0;for(var r=e.length,o=!1,l=0;--r>=0;){var p=8==n?255&e[r]:s(e,r);if(p<0)"-"==e.charAt(r)&&(o=!0);else{o=!1;if(0==l)this[this.t++]=p;else if(l+n>this.DB){this[this.t-1]|=(p&(1<<this.DB-l)-1)<<l;this[this.t++]=p>>this.DB-l}else this[this.t-1]|=p<<l;l+=n;l>=this.DB&&(l-=this.DB)}}if(8==n&&0!=(128&e[0])){this.s=-1;l>0&&(this[this.t-1]|=(1<<this.DB-l)-1<<l)}this.clamp();o&&t.ZERO.subTo(this,this)}function u(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function f(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,n=(1<<e)-1,r=!1,s="",l=this.t,p=this.DB-l*this.DB%e;if(l-- >0){if(p<this.DB&&(i=this[l]>>p)>0){r=!0;s=o(i)}for(;l>=0;){if(p<e){i=(this[l]&(1<<p)-1)<<e-p;i|=this[--l]>>(p+=this.DB-e)}else{i=this[l]>>(p-=e)&n;if(p<=0){p+=this.DB;--l}}i>0&&(r=!0);r&&(s+=o(i))}}return r?s:"0"}function d(){var i=e();t.ZERO.subTo(this,i);return i}function y(){return this.s<0?this.negate():this}function c(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;e=i-t.t;if(0!=e)return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0}function m(t){var e,i=1;if(0!=(e=t>>>16)){t=e;i+=16}if(0!=(e=t>>8)){t=e;i+=8}if(0!=(e=t>>4)){t=e;i+=4}if(0!=(e=t>>2)){t=e;i+=2}if(0!=(e=t>>1)){t=e;i+=1}return i}function x(){return this.t<=0?0:this.DB*(this.t-1)+m(this[this.t-1]^this.s&this.DM)}function g(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t;e.s=this.s}function v(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0);e.s=this.s}function I(t,e){var i,n=t%this.DB,r=this.DB-n,o=(1<<r)-1,s=Math.floor(t/this.DB),l=this.s<<n&this.DM;for(i=this.t-1;i>=0;--i){e[i+s+1]=this[i]>>r|l;l=(this[i]&o)<<n}for(i=s-1;i>=0;--i)e[i]=0;e[s]=l;e.t=this.t+s+1;e.s=this.s;e.clamp()}function P(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)e.t=0;else{var n=t%this.DB,r=this.DB-n,o=(1<<n)-1;e[0]=this[i]>>n;for(var s=i+1;s<this.t;++s){e[s-i-1]|=(this[s]&o)<<r;e[s-i]=this[s]>>n}n>0&&(e[this.t-i-1]|=(this.s&o)<<r);e.t=this.t-i;e.clamp()}}function C(t,e){for(var i=0,n=0,r=Math.min(t.t,this.t);i<r;){n+=this[i]-t[i];e[i++]=n&this.DM;n>>=this.DB}if(t.t<this.t){n-=t.s;for(;i<this.t;){n+=this[i];e[i++]=n&this.DM;n>>=this.DB}n+=this.s}else{n+=this.s;for(;i<t.t;){n-=t[i];e[i++]=n&this.DM;n>>=this.DB}n-=t.s}e.s=n<0?-1:0;n<-1?e[i++]=this.DV+n:n>0&&(e[i++]=n);e.t=i;e.clamp()}function L(e,i){var n=this.abs(),r=e.abs(),o=n.t;i.t=o+r.t;for(;--o>=0;)i[o]=0;for(o=0;o<r.t;++o)i[o+n.t]=n.am(0,r[o],i,o,0,n.t);i.s=0;i.clamp();this.s!=e.s&&t.ZERO.subTo(i,i)}function E(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var n=e.am(i,e[i],t,2*i,0,1);if((t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,n,e.t-i-1))>=e.DV){t[i+e.t]-=e.DV;t[i+e.t+1]=1}}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1));t.s=0;t.clamp()}function _(i,n,r){var o=i.abs();if(!(o.t<=0)){var s=this.abs();if(s.t<o.t){null!=n&&n.fromInt(0);null!=r&&this.copyTo(r)}else{null==r&&(r=e());var l=e(),p=this.s,h=i.s,a=this.DB-m(o[o.t-1]);if(a>0){o.lShiftTo(a,l);s.lShiftTo(a,r)}else{o.copyTo(l);s.copyTo(r)}var u=l.t,f=l[u-1];if(0!=f){var d=f*(1<<this.F1)+(u>1?l[u-2]>>this.F2:0),y=this.FV/d,c=(1<<this.F1)/d,x=1<<this.F2,g=r.t,v=g-u,I=null==n?e():n;l.dlShiftTo(v,I);if(r.compareTo(I)>=0){r[r.t++]=1;r.subTo(I,r)}t.ONE.dlShiftTo(u,I);I.subTo(l,l);for(;l.t<u;)l[l.t++]=0;for(;--v>=0;){var P=r[--g]==f?this.DM:Math.floor(r[g]*y+(r[g-1]+x)*c);if((r[g]+=l.am(0,P,r,v,0,u))<P){l.dlShiftTo(v,I);r.subTo(I,r);for(;r[g]<--P;)r.subTo(I,r)}}if(null!=n){r.drShiftTo(u,n);p!=h&&t.ZERO.subTo(n,n)}r.t=u;r.clamp();a>0&&r.rShiftTo(a,r);p<0&&t.ZERO.subTo(r,r)}}}}function b(i){var n=e();this.abs().divRemTo(i,null,n);this.s<0&&n.compareTo(t.ZERO)>0&&i.subTo(n,n);return n}function T(t){this.m=t}function A(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function M(t){return t}function S(t){t.divRemTo(this.m,null,t)}function w(t,e,i){t.multiplyTo(e,i);this.reduce(i)}function R(t,e){t.squareTo(e);this.reduce(e)}function B(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;e=e*(2-(15&t)*e)&15;e=e*(2-(255&t)*e)&255;e=e*(2-((65535&t)*e&65535))&65535;e=e*(2-t*e%this.DV)%this.DV;return e>0?this.DV-e:-e}function O(t){this.m=t;this.mp=t.invDigit();this.mpl=32767&this.mp;this.mph=this.mp>>15;this.um=(1<<t.DB-15)-1;this.mt2=2*t.t}function D(i){var n=e();i.abs().dlShiftTo(this.m.t,n);n.divRemTo(this.m,null,n);i.s<0&&n.compareTo(t.ZERO)>0&&this.m.subTo(n,n);return n}function V(t){var i=e();t.copyTo(i);this.reduce(i);return i}function F(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],n=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;i=e+this.m.t;t[i]+=this.m.am(0,n,t,e,0,this.m.t);for(;t[i]>=t.DV;){t[i]-=t.DV;t[++i]++}}t.clamp();t.drShiftTo(this.m.t,t);t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function k(t,e){t.squareTo(e);this.reduce(e)}function N(t,e,i){t.multiplyTo(e,i);this.reduce(i)}function X(){return 0==(this.t>0?1&this[0]:this.s)}function Y(i,n){if(i>4294967295||i<1)return t.ONE;var r=e(),o=e(),s=n.convert(this),l=m(i)-1;s.copyTo(r);for(;--l>=0;){n.sqrTo(r,o);if((i&1<<l)>0)n.mulTo(o,s,r);else{var p=r;r=o;o=p}}return n.revert(r)}function j(t,e){var i;i=t<256||e.isEven()?new T(e):new O(e);return this.exp(t,i)}function q(){var t=e();this.copyTo(t);return t}function H(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function J(){return 0==this.t?this.s:this[0]<<24>>24}function U(){return 0==this.t?this.s:this[0]<<16>>16}function z(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function W(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function G(t){null==t&&(t=10);if(0==this.signum()||t<2||t>36)return"0";var i=this.chunkSize(t),n=Math.pow(t,i),r=h(n),o=e(),s=e(),l="";this.divRemTo(r,o,s);for(;o.signum()>0;){l=(n+s.intValue()).toString(t).substr(1)+l;o.divRemTo(r,o,s)}return s.intValue().toString(t)+l}function Z(e,i){this.fromInt(0);null==i&&(i=10);for(var n=this.chunkSize(i),r=Math.pow(i,n),o=!1,l=0,p=0,h=0;h<e.length;++h){var a=s(e,h);if(a<0)"-"==e.charAt(h)&&0==this.signum()&&(o=!0);else{p=i*p+a;if(++l>=n){this.dMultiply(r);this.dAddOffset(p,0);l=0;p=0}}}if(l>0){this.dMultiply(Math.pow(i,l));this.dAddOffset(p,0)}o&&t.ZERO.subTo(this,this)}function $(e,i,n){if("number"==typeof i)if(e<2)this.fromInt(1);else{this.fromNumber(e,n);this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),ot,this);this.isEven()&&this.dAddOffset(1,0);for(;!this.isProbablePrime(i);){this.dAddOffset(2,0);this.bitLength()>e&&this.subTo(t.ONE.shiftLeft(e-1),this)}}else{var r=[],o=7&e;r.length=1+(e>>3);i.nextBytes(r);o>0?r[0]&=(1<<o)-1:r[0]=0;this.fromString(r,256)}}function K(){var t=this.t,e=[];e[0]=this.s;var i,n=this.DB-t*this.DB%8,r=0;if(t-- >0){n<this.DB&&(i=this[t]>>n)!=(this.s&this.DM)>>n&&(e[r++]=i|this.s<<this.DB-n);for(;t>=0;){if(n<8){i=(this[t]&(1<<n)-1)<<8-n;i|=this[--t]>>(n+=this.DB-8)}else{i=this[t]>>(n-=8)&255;if(n<=0){n+=this.DB;--t}}0!=(128&i)&&(i|=-256);0==r&&(128&this.s)!=(128&i)&&++r;(r>0||i!=this.s)&&(e[r++]=i)}}return e}function Q(t){return 0==this.compareTo(t)}function tt(t){return this.compareTo(t)<0?this:t}function et(t){return this.compareTo(t)>0?this:t}function it(t,e,i){var n,r,o=Math.min(t.t,this.t);for(n=0;n<o;++n)i[n]=e(this[n],t[n]);if(t.t<this.t){r=t.s&this.DM;for(n=o;n<this.t;++n)i[n]=e(this[n],r);i.t=this.t}else{r=this.s&this.DM;for(n=o;n<t.t;++n)i[n]=e(r,t[n]);i.t=t.t}i.s=e(this.s,t.s);i.clamp()}function nt(t,e){return t&e}function rt(t){var i=e();this.bitwiseTo(t,nt,i);return i}function ot(t,e){return t|e}function st(t){var i=e();this.bitwiseTo(t,ot,i);return i}function lt(t,e){return t^e}function pt(t){var i=e();this.bitwiseTo(t,lt,i);return i}function ht(t,e){return t&~e}function at(t){var i=e();this.bitwiseTo(t,ht,i);return i}function ut(){for(var t=e(),i=0;i<this.t;++i)t[i]=this.DM&~this[i];t.t=this.t;t.s=~this.s;return t}function ft(t){var i=e();t<0?this.rShiftTo(-t,i):this.lShiftTo(t,i);return i}function dt(t){var i=e();t<0?this.lShiftTo(-t,i):this.rShiftTo(t,i);return i}function yt(t){if(0==t)return-1;var e=0;if(0==(65535&t)){t>>=16;e+=16}if(0==(255&t)){t>>=8;e+=8}if(0==(15&t)){t>>=4;e+=4}if(0==(3&t)){t>>=2;e+=2}0==(1&t)&&++e;return e}function ct(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+yt(this[t]);return this.s<0?this.t*this.DB:-1}function mt(t){for(var e=0;0!=t;){t&=t-1;++e}return e}function xt(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=mt(this[i]^e);return t}function gt(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function vt(e,i){var n=t.ONE.shiftLeft(e);this.bitwiseTo(n,i,n);return n}function It(t){return this.changeBit(t,ot)}function Pt(t){return this.changeBit(t,ht)}function Ct(t){return this.changeBit(t,lt)}function Lt(t,e){for(var i=0,n=0,r=Math.min(t.t,this.t);i<r;){n+=this[i]+t[i];e[i++]=n&this.DM;n>>=this.DB}if(t.t<this.t){n+=t.s;for(;i<this.t;){n+=this[i];e[i++]=n&this.DM;n>>=this.DB}n+=this.s}else{n+=this.s;for(;i<t.t;){n+=t[i];e[i++]=n&this.DM;n>>=this.DB}n+=t.s}e.s=n<0?-1:0;n>0?e[i++]=n:n<-1&&(e[i++]=this.DV+n);e.t=i;e.clamp()}function Et(t){var i=e();this.addTo(t,i);return i}function _t(t){var i=e();this.subTo(t,i);return i}function bt(t){var i=e();this.multiplyTo(t,i);return i}function Tt(){var t=e();this.squareTo(t);return t}function At(t){var i=e();this.divRemTo(t,i,null);return i}function Mt(t){var i=e();this.divRemTo(t,null,i);return i}function St(t){var i=e(),n=e();this.divRemTo(t,i,n);return new Array(i,n)}function wt(t){this[this.t]=this.am(0,t-1,this,0,0,this.t);++this.t;this.clamp()}function Rt(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;this[e]+=t;for(;this[e]>=this.DV;){this[e]-=this.DV;++e>=this.t&&(this[this.t++]=0);++this[e]}}}function Bt(){}function Ot(t){return t}function Dt(t,e,i){t.multiplyTo(e,i)}function Vt(t,e){t.squareTo(e)}function Ft(t){return this.exp(t,new Bt)}function kt(t,e,i){var n=Math.min(this.t+t.t,e);i.s=0;i.t=n;for(;n>0;)i[--n]=0;var r;for(r=i.t-this.t;n<r;++n)i[n+this.t]=this.am(0,t[n],i,n,0,this.t);for(r=Math.min(t.t,e);n<r;++n)this.am(0,t[n],i,n,0,e-n);i.clamp()}function Nt(t,e,i){--e;var n=i.t=this.t+t.t-e;i.s=0;for(;--n>=0;)i[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)i[this.t+n-e]=this.am(e-n,t[n],i,0,0,this.t+n-e);i.clamp();i.drShiftTo(1,i)}function Xt(i){this.r2=e();this.q3=e();t.ONE.dlShiftTo(2*i.t,this.r2);this.mu=this.r2.divide(i);this.m=i}function Yt(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var i=e();t.copyTo(i);this.reduce(i);return i}function jt(t){return t}function qt(t){t.drShiftTo(this.m.t-1,this.r2);if(t.t>this.m.t+1){t.t=this.m.t+1;t.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);for(;t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);t.subTo(this.r2,t);for(;t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Ht(t,e){t.squareTo(e);this.reduce(e)}function Jt(t,e,i){t.multiplyTo(e,i);this.reduce(i)}function Ut(t,i){var n,r,o=t.bitLength(),s=h(1);if(o<=0)return s;n=o<18?1:o<48?3:o<144?4:o<768?5:6;r=o<8?new T(i):i.isEven()?new Xt(i):new O(i);var l=[],p=3,a=n-1,u=(1<<n)-1;l[1]=r.convert(this);if(n>1){var f=e();r.sqrTo(l[1],f);for(;p<=u;){l[p]=e();r.mulTo(f,l[p-2],l[p]);p+=2}}var d,y,c=t.t-1,x=!0,g=e();o=m(t[c])-1;for(;c>=0;){if(o>=a)d=t[c]>>o-a&u;else{d=(t[c]&(1<<o+1)-1)<<a-o;c>0&&(d|=t[c-1]>>this.DB+o-a)}p=n;for(;0==(1&d);){d>>=1;--p}if((o-=p)<0){o+=this.DB;--c}if(x){l[d].copyTo(s);x=!1}else{for(;p>1;){r.sqrTo(s,g);r.sqrTo(g,s);p-=2}if(p>0)r.sqrTo(s,g);else{y=s;s=g;g=y}r.mulTo(g,l[d],s)}for(;c>=0&&0==(t[c]&1<<o);){r.sqrTo(s,g);y=s;s=g;g=y;if(--o<0){o=this.DB-1;--c}}}return r.revert(s)}function zt(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var n=e;e=i;i=n}var r=e.getLowestSetBit(),o=i.getLowestSetBit();if(o<0)return e;r<o&&(o=r);if(o>0){e.rShiftTo(o,e);i.rShiftTo(o,i)}for(;e.signum()>0;){(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e);(r=i.getLowestSetBit())>0&&i.rShiftTo(r,i);if(e.compareTo(i)>=0){e.subTo(i,e);e.rShiftTo(1,e)}else{i.subTo(e,i);i.rShiftTo(1,i)}}o>0&&i.lShiftTo(o,i);return i}function Wt(t){if(t<=0)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(var n=this.t-1;n>=0;--n)i=(e*i+this[n])%t;return i}function Gt(e){var i=e.isEven();if(this.isEven()&&i||0==e.signum())return t.ZERO;for(var n=e.clone(),r=this.clone(),o=h(1),s=h(0),l=h(0),p=h(1);0!=n.signum();){for(;n.isEven();){n.rShiftTo(1,n);if(i){if(!o.isEven()||!s.isEven()){o.addTo(this,o);s.subTo(e,s)}o.rShiftTo(1,o)}else s.isEven()||s.subTo(e,s);s.rShiftTo(1,s)}for(;r.isEven();){r.rShiftTo(1,r);if(i){if(!l.isEven()||!p.isEven()){l.addTo(this,l);p.subTo(e,p)}l.rShiftTo(1,l)}else p.isEven()||p.subTo(e,p);p.rShiftTo(1,p)}if(n.compareTo(r)>=0){n.subTo(r,n);i&&o.subTo(l,o);s.subTo(p,s)}else{r.subTo(n,r);i&&l.subTo(o,l);p.subTo(s,p)}}if(0!=r.compareTo(t.ONE))return t.ZERO;if(p.compareTo(e)>=0)return p.subtract(e);if(!(p.signum()<0))return p;p.addTo(e,p);return p.signum()<0?p.add(e):p}function Zt(t){var e,i=this.abs();if(1==i.t&&i[0]<=pe[pe.length-1]){for(e=0;e<pe.length;++e)if(i[0]==pe[e])return!0;return!1}if(i.isEven())return!1;e=1;for(;e<pe.length;){for(var n=pe[e],r=e+1;r<pe.length&&n<he;)n*=pe[r++];n=i.modInt(n);for(;e<r;)if(n%pe[e++]==0)return!1}return i.millerRabin(t)}function $t(i){var n=this.subtract(t.ONE),r=n.getLowestSetBit();if(r<=0)return!1;var o=n.shiftRight(r);i=i+1>>1;i>pe.length&&(i=pe.length);for(var s=e(),l=0;l<i;++l){s.fromInt(pe[Math.floor(Math.random()*pe.length)]);var p=s.modPow(o,this);if(0!=p.compareTo(t.ONE)&&0!=p.compareTo(n)){for(var h=1;h++<r&&0!=p.compareTo(n);){p=p.modPowInt(2,this);if(0==p.compareTo(t.ONE))return!1}if(0!=p.compareTo(n))return!1}}return!0}var Kt={},Qt=!1;if("undefined"!=typeof module&&module.exports){module.exports=Kt;Qt=!0}else"undefined"!=typeof document?window.ClipperLib=Kt:self.ClipperLib=Kt;var te;if(Qt){var ee="chrome";te="Netscape"}else{var ee=navigator.userAgent.toString().toLowerCase();te=navigator.appName}var ie={};-1!=ee.indexOf("chrome")&&-1==ee.indexOf("chromium")?ie.chrome=1:ie.chrome=0;-1!=ee.indexOf("chromium")?ie.chromium=1:ie.chromium=0;-1!=ee.indexOf("safari")&&-1==ee.indexOf("chrome")&&-1==ee.indexOf("chromium")?ie.safari=1:ie.safari=0;-1!=ee.indexOf("firefox")?ie.firefox=1:ie.firefox=0;-1!=ee.indexOf("firefox/17")?ie.firefox17=1:ie.firefox17=0;-1!=ee.indexOf("firefox/15")?ie.firefox15=1:ie.firefox15=0;-1!=ee.indexOf("firefox/3")?ie.firefox3=1:ie.firefox3=0;-1!=ee.indexOf("opera")?ie.opera=1:ie.opera=0;-1!=ee.indexOf("msie 10")?ie.msie10=1:ie.msie10=0;-1!=ee.indexOf("msie 9")?ie.msie9=1:ie.msie9=0;-1!=ee.indexOf("msie 8")?ie.msie8=1:ie.msie8=0;-1!=ee.indexOf("msie 7")?ie.msie7=1:ie.msie7=0;-1!=ee.indexOf("msie ")?ie.msie=1:ie.msie=0;Kt.biginteger_used=null;var ne;if("Microsoft Internet Explorer"==te){t.prototype.am=n;ne=30}else if("Netscape"!=te){t.prototype.am=i;ne=26}else{t.prototype.am=r;ne=28}t.prototype.DB=ne;t.prototype.DM=(1<<ne)-1;t.prototype.DV=1<<ne;t.prototype.FV=Math.pow(2,52);t.prototype.F1=52-ne;t.prototype.F2=2*ne-52;var re,oe,se="0123456789abcdefghijklmnopqrstuvwxyz",le=[];re="0".charCodeAt(0);for(oe=0;oe<=9;++oe)le[re++]=oe;re="a".charCodeAt(0);for(oe=10;oe<36;++oe)le[re++]=oe;re="A".charCodeAt(0);for(oe=10;oe<36;++oe)le[re++]=oe;T.prototype.convert=A;T.prototype.revert=M;T.prototype.reduce=S;T.prototype.mulTo=w;T.prototype.sqrTo=R;O.prototype.convert=D;O.prototype.revert=V;O.prototype.reduce=F;O.prototype.mulTo=N;O.prototype.sqrTo=k;t.prototype.copyTo=l;t.prototype.fromInt=p;t.prototype.fromString=a;t.prototype.clamp=u;t.prototype.dlShiftTo=g;t.prototype.drShiftTo=v;t.prototype.lShiftTo=I;t.prototype.rShiftTo=P;t.prototype.subTo=C;t.prototype.multiplyTo=L;t.prototype.squareTo=E;t.prototype.divRemTo=_;t.prototype.invDigit=B;t.prototype.isEven=X;t.prototype.exp=Y;t.prototype.toString=f;t.prototype.negate=d;t.prototype.abs=y;t.prototype.compareTo=c;t.prototype.bitLength=x;t.prototype.mod=b;t.prototype.modPowInt=j;t.ZERO=h(0);t.ONE=h(1);Bt.prototype.convert=Ot;Bt.prototype.revert=Ot;Bt.prototype.mulTo=Dt;Bt.prototype.sqrTo=Vt;Xt.prototype.convert=Yt;Xt.prototype.revert=jt;Xt.prototype.reduce=qt;Xt.prototype.mulTo=Jt;Xt.prototype.sqrTo=Ht;var pe=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],he=(1<<26)/pe[pe.length-1];t.prototype.chunkSize=z;t.prototype.toRadix=G;t.prototype.fromRadix=Z;t.prototype.fromNumber=$;t.prototype.bitwiseTo=it;t.prototype.changeBit=vt;t.prototype.addTo=Lt;t.prototype.dMultiply=wt;t.prototype.dAddOffset=Rt;t.prototype.multiplyLowerTo=kt;t.prototype.multiplyUpperTo=Nt;t.prototype.modInt=Wt;t.prototype.millerRabin=$t;t.prototype.clone=q;t.prototype.intValue=H;t.prototype.byteValue=J;t.prototype.shortValue=U;t.prototype.signum=W;t.prototype.toByteArray=K;t.prototype.equals=Q;t.prototype.min=tt;t.prototype.max=et;t.prototype.and=rt;t.prototype.or=st;t.prototype.xor=pt;t.prototype.andNot=at;t.prototype.not=ut;t.prototype.shiftLeft=ft;t.prototype.shiftRight=dt;t.prototype.getLowestSetBit=ct;t.prototype.bitCount=xt;t.prototype.testBit=gt;t.prototype.setBit=It;t.prototype.clearBit=Pt;t.prototype.flipBit=Ct;t.prototype.add=Et;t.prototype.subtract=_t;t.prototype.multiply=bt;t.prototype.divide=At;t.prototype.remainder=Mt;t.prototype.divideAndRemainder=St;t.prototype.modPow=Ut;t.prototype.modInverse=Gt;t.prototype.pow=Ft;t.prototype.gcd=zt;t.prototype.isProbablePrime=Zt;t.prototype.square=Tt;Kt.Math_Abs_Int64=Kt.Math_Abs_Int32=Kt.Math_Abs_Double=function(t){return Math.abs(t)};Kt.Math_Max_Int32_Int32=function(t,e){return Math.max(t,e)};ie.msie||ie.opera||ie.safari?Kt.Cast_Int32=function(t){return 0|t}:Kt.Cast_Int32=function(t){return~~t};ie.chrome?Kt.Cast_Int64=function(t){return t<-2147483648||t>2147483647?t<0?Math.ceil(t):Math.floor(t):~~t}:ie.firefox&&"function"==typeof Number.toInteger?Kt.Cast_Int64=function(t){return Number.toInteger(t)}:ie.msie7||ie.msie8?Kt.Cast_Int64=function(t){return parseInt(t,10)}:ie.msie?Kt.Cast_Int64=function(t){return t<-2147483648||t>2147483647?t<0?Math.ceil(t):Math.floor(t):0|t}:Kt.Cast_Int64=function(t){return t<0?Math.ceil(t):Math.floor(t)};Kt.Clear=function(t){t.length=0};Kt.MaxSteps=64;Kt.PI=3.141592653589793;Kt.PI2=6.283185307179586;Kt.IntPoint=function(){var t=arguments;if(1==t.length){this.x=t[0].x;this.y=t[0].y}if(2==t.length){this.x=t[0];this.y=t[1]}};Kt.IntRect=function(){var t=arguments;if(4==t.length){var e=t[0],i=t[1],n=t[2],r=t[3];this.left=e;this.top=i;this.right=n;this.bottom=r}else{this.left=0;this.top=0;this.right=0;this.bottom=0}};Kt.Polygon=function(){return[]};Kt.Polygons=function(){return[]};Kt.ExPolygons=function(){var t=[];t.exPolygons=!0;return t};Kt.ExPolygon=function(){this.outer=null;this.holes=null};Kt.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3};Kt.PolyType={ptSubject:0,ptClip:1};Kt.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3};Kt.JoinType={jtSquare:0,jtRound:1,jtMiter:2};Kt.EdgeSide={esLeft:1,esRight:2};Kt.Protects={ipNone:0,ipLeft:1,ipRight:2,ipBoth:3};Kt.Direction={dRightToLeft:0,dLeftToRight:1};Kt.TEdge=function(){this.xbot=0;this.ybot=0;this.xcurr=0;this.ycurr=0;this.xtop=0;this.ytop=0;this.dx=0;this.deltaX=0;this.deltaY=0;this.tmpX=0;this.polyType=Kt.PolyType.ptSubject;this.side=null;this.windDelta=0;this.windCnt=0;this.windCnt2=0;this.outIdx=0;this.next=null;this.prev=null;this.nextInLML=null;this.nextInAEL=null;this.prevInAEL=null;this.nextInSEL=null;this.prevInSEL=null};Kt.IntersectNode=function(){this.edge1=null;this.edge2=null;this.pt=null;this.next=null};Kt.LocalMinima=function(){this.y=0;this.leftBound=null;this.rightBound=null;this.next=null};Kt.Scanbeam=function(){this.y=0;this.next=null};Kt.OutRec=function(){this.idx=0;this.isHole=!1;this.FirstLeft=null;this.AppendLink=null;this.pts=null;this.bottomPt=null};Kt.OutPt=function(){this.idx=0;this.pt=null;this.next=null;this.prev=null};Kt.JoinRec=function(){this.pt1a=null;this.pt1b=null;this.poly1Idx=0;this.pt2a=null;this.pt2b=null;this.poly2Idx=0};Kt.HorzJoinRec=function(){this.edge=null;this.savedIdx=0};Kt.ClipperBase=function(){this.m_MinimaList=null;this.m_CurrentLM=null;this.m_edges=[[]];this.m_UseFullRange=!1};Kt.ClipperBase.horizontal=-9007199254740992;Kt.ClipperBase.loRange=47453132;Kt.ClipperBase.hiRange=0xfffffffffffff;Kt.ClipperBase.PointsEqual=function(t,e){return t.x==e.x&&t.y==e.y};Kt.ClipperBase.prototype.PointIsVertex=function(t,e){var i=e;do{if(Kt.ClipperBase.PointsEqual(i.pt,t))return!0;i=i.next}while(i!=e);return!1};Kt.ClipperBase.prototype.PointInPolygon=function(e,i,n){var r=i,o=!1;if(n)do{(r.pt.y<=e.y&&e.y<r.prev.pt.y||r.prev.pt.y<=e.y&&e.y<r.pt.y)&&new t(e.x-r.pt.x).compareTo(new t(r.prev.pt.x-r.pt.x).multiply(new t(e.y-r.pt.y)).divide(new t(r.prev.pt.y-r.pt.y)))<0&&(o=!o);r=r.next}while(r!=i);else do{(r.pt.y<=e.y&&e.y<r.prev.pt.y||r.prev.pt.y<=e.y&&e.y<r.pt.y)&&e.x-r.pt.x<(r.prev.pt.x-r.pt.x)*(e.y-r.pt.y)/(r.prev.pt.y-r.pt.y)&&(o=!o);r=r.next}while(r!=i);return o}
;Kt.ClipperBase.prototype.SlopesEqual=Kt.ClipperBase.SlopesEqual=function(){var e,i,n,r,o,s,l,p=arguments;if(3==p.length){e=p[0],i=p[1],l=p[2];return l?new t(e.deltaY).multiply(new t(i.deltaX)).toString()==new t(e.deltaX).multiply(new t(i.deltaY)).toString():e.deltaY*i.deltaX==e.deltaX*i.deltaY}if(4==p.length){n=p[0],r=p[1],o=p[2],l=p[3];return l?new t(n.y-r.y).multiply(new t(r.x-o.x)).toString()==new t(n.x-r.x).multiply(new t(r.y-o.y)).toString():(n.y-r.y)*(r.x-o.x)-(n.x-r.x)*(r.y-o.y)==0}if(5==p.length){n=p[0],r=p[1],o=p[2],s=p[3],l=p[4];return l?new t(n.y-r.y).multiply(new t(o.x-s.x)).toString()==new t(n.x-r.x).multiply(new t(o.y-s.y)).toString():(n.y-r.y)*(o.x-s.x)-(n.x-r.x)*(o.y-s.y)==0}};Kt.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var t=0;t<this.m_edges.length;++t){for(var e=0;e<this.m_edges[t].length;++e)this.m_edges[t][e]=null;Kt.Clear(this.m_edges[t])}Kt.Clear(this.m_edges);this.m_UseFullRange=!1};Kt.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!=this.m_MinimaList;){var t=this.m_MinimaList.next;this.m_MinimaList=null;this.m_MinimaList=t}this.m_CurrentLM=null};Kt.ClipperBase.prototype.AddPolygons=function(t,e){var i=!1,n=!1;if(!Array.isArray(t))return i;for(var r=0;r<t.length;++r){n=this.AddPolygon(t[r],e,!0);if(n&&"exceed"!=n)i=!0;else if("exceed"==n)break}"exceed"==n&&Kt.Error("Coordinate exceeds range bounds in AddPolygons().");return i};Kt.ClipperBase.prototype.AddPolygon=function(t,e,i){if(!Array.isArray(t))return!1;var n=t.length;if(n<3)return!1;var r=new Kt.Polygon;r.push(new Kt.IntPoint(t[0].x,t[0].y));var o,s=0,l=!1;for(o=1;o<n;++o){var p;p=this.m_UseFullRange?Kt.ClipperBase.hiRange:Kt.ClipperBase.loRange;if(Kt.Math_Abs_Int64(t[o].x)>p||Kt.Math_Abs_Int64(t[o].y)>p){if(Kt.Math_Abs_Int64(t[o].x)>Kt.ClipperBase.hiRange||Kt.Math_Abs_Int64(t[o].y)>Kt.ClipperBase.hiRange){if(void 0!==i)return"exceed";l=!0;break}p=Kt.ClipperBase.hiRange;this.m_UseFullRange=!0}if(!Kt.ClipperBase.PointsEqual(r[s],t[o])){s>0&&this.SlopesEqual(r[s-1],r[s],t[o],this.m_UseFullRange)?Kt.ClipperBase.PointsEqual(r[s-1],t[o])&&s--:s++;s<r.length?r[s]=t[o]:r.push(new Kt.IntPoint(t[o].x,t[o].y))}}l&&void 0===i&&Kt.Error("Coordinate exceeds range bounds in AddPolygon()");if(s<2)return!1;n=s+1;for(;n>2;){if(Kt.ClipperBase.PointsEqual(r[s],r[0]))s--;else if(Kt.ClipperBase.PointsEqual(r[0],r[1])||this.SlopesEqual(r[s],r[0],r[1],this.m_UseFullRange))r[0]=r[s--];else if(this.SlopesEqual(r[s-1],r[s],r[0],this.m_UseFullRange))s--;else{if(!this.SlopesEqual(r[0],r[1],r[2],this.m_UseFullRange))break;for(o=2;o<=s;++o)r[o-1]=r[o];s--}n--}if(n<3)return!1;var h=[];for(o=0;o<n;o++)h.push(new Kt.TEdge);this.m_edges.push(h);h[0].xcurr=r[0].x;h[0].ycurr=r[0].y;this.InitEdge(h[n-1],h[0],h[n-2],r[n-1],e);for(o=n-2;o>0;--o)this.InitEdge(h[o],h[o+1],h[o-1],r[o],e);this.InitEdge(h[0],h[1],h[n-1],r[0],e);var a=h[0],u=a;do{a.xcurr=a.xbot;a.ycurr=a.ybot;a.ytop<u.ytop&&(u=a);a=a.next}while(a!=h[0]);u.windDelta>0&&(u=u.next);u.dx==Kt.ClipperBase.horizontal&&(u=u.next);a=u;do{a=this.AddBoundsToLML(a)}while(a!=u);return!0};Kt.ClipperBase.prototype.InitEdge=function(t,e,i,n,r){t.next=e;t.prev=i;t.xcurr=n.x;t.ycurr=n.y;if(t.ycurr>=t.next.ycurr){t.xbot=t.xcurr;t.ybot=t.ycurr;t.xtop=t.next.xcurr;t.ytop=t.next.ycurr;t.windDelta=1}else{t.xtop=t.xcurr;t.ytop=t.ycurr;t.xbot=t.next.xcurr;t.ybot=t.next.ycurr;t.windDelta=-1}this.SetDx(t);t.polyType=r;t.outIdx=-1};Kt.ClipperBase.prototype.SetDx=function(t){t.deltaX=t.xtop-t.xbot;t.deltaY=t.ytop-t.ybot;0==t.deltaY?t.dx=Kt.ClipperBase.horizontal:t.dx=t.deltaX/t.deltaY};Kt.ClipperBase.prototype.AddBoundsToLML=function(t){t.nextInLML=null;t=t.next;for(;;){if(t.dx==Kt.ClipperBase.horizontal){if(t.next.ytop<t.ytop&&t.next.xbot>t.prev.xbot)break;t.xtop!=t.prev.xbot&&this.SwapX(t);t.nextInLML=t.prev}else{if(t.ycurr==t.prev.ycurr)break;t.nextInLML=t.prev}t=t.next}var e=new Kt.LocalMinima;e.next=null;e.y=t.prev.ybot;if(t.dx==Kt.ClipperBase.horizontal){t.xbot!=t.prev.xbot&&this.SwapX(t);e.leftBound=t.prev;e.rightBound=t}else if(t.dx<t.prev.dx){e.leftBound=t.prev;e.rightBound=t}else{e.leftBound=t;e.rightBound=t.prev}e.leftBound.side=Kt.EdgeSide.esLeft;e.rightBound.side=Kt.EdgeSide.esRight;this.InsertLocalMinima(e);for(;t.next.ytop!=t.ytop||t.next.dx==Kt.ClipperBase.horizontal;){t.nextInLML=t.next;t=t.next;t.dx==Kt.ClipperBase.horizontal&&t.xbot!=t.prev.xtop&&this.SwapX(t)}return t.next};Kt.ClipperBase.prototype.InsertLocalMinima=function(t){if(null==this.m_MinimaList)this.m_MinimaList=t;else if(t.y>=this.m_MinimaList.y){t.next=this.m_MinimaList;this.m_MinimaList=t}else{for(var e=this.m_MinimaList;null!=e.next&&t.y<e.next.y;)e=e.next;t.next=e.next;e.next=t}};Kt.ClipperBase.prototype.PopLocalMinima=function(){null!=this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.next)};Kt.ClipperBase.prototype.SwapX=function(t){t.xcurr=t.xtop;t.xtop=t.xbot;t.xbot=t.xcurr};Kt.ClipperBase.prototype.Reset=function(){this.m_CurrentLM=this.m_MinimaList;for(var t=this.m_MinimaList;null!=t;){for(var e=t.leftBound;null!=e;){e.xcurr=e.xbot;e.ycurr=e.ybot;e.side=Kt.EdgeSide.esLeft;e.outIdx=-1;e=e.nextInLML}e=t.rightBound;for(;null!=e;){e.xcurr=e.xbot;e.ycurr=e.ybot;e.side=Kt.EdgeSide.esRight;e.outIdx=-1;e=e.nextInLML}t=t.next}};Kt.ClipperBase.prototype.GetBounds=function(){var t=new Kt.IntRect,e=this.m_MinimaList;if(null==e)return t;t.left=e.leftBound.xbot;t.top=e.leftBound.ybot;t.right=e.leftBound.xbot;t.bottom=e.leftBound.ybot;for(;null!=e;){e.leftBound.ybot>t.bottom&&(t.bottom=e.leftBound.ybot);for(var i=e.leftBound;;){for(var n=i;null!=i.nextInLML;){i.xbot<t.left&&(t.left=i.xbot);i.xbot>t.right&&(t.right=i.xbot);i=i.nextInLML}i.xbot<t.left&&(t.left=i.xbot);i.xbot>t.right&&(t.right=i.xbot);i.xtop<t.left&&(t.left=i.xtop);i.xtop>t.right&&(t.right=i.xtop);i.ytop<t.top&&(t.top=i.ytop);if(n!=e.leftBound)break;i=e.rightBound}e=e.next}return t};Kt.Clipper=function(){this.m_PolyOuts=null;this.m_ClipType=Kt.ClipType.ctIntersection;this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.m_IntersectNodes=null;this.m_ExecuteLocked=!1;this.m_ClipFillType=Kt.PolyFillType.pftEvenOdd;this.m_SubjFillType=Kt.PolyFillType.pftEvenOdd;this.m_Joins=null;this.m_HorizJoins=null;this.m_ReverseOutput=!1;this.m_UsingExPolygons=!1;Kt.ClipperBase.call(this);this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.m_IntersectNodes=null;this.m_ExecuteLocked=!1;this.m_PolyOuts=[];this.m_Joins=[];this.m_HorizJoins=[];this.m_ReverseOutput=!1;this.m_UsingExPolygons=!1};Kt.Clipper.prototype.Clear=function(){if(0!=this.m_edges.length){this.DisposeAllPolyPts();Kt.ClipperBase.prototype.Clear.call(this)}};Kt.Clipper.prototype.DisposeScanbeamList=function(){for(;null!=this.m_Scanbeam;){var t=this.m_Scanbeam.next;this.m_Scanbeam=null;this.m_Scanbeam=t}};Kt.Clipper.prototype.Reset=function(){Kt.ClipperBase.prototype.Reset.call(this);this.m_Scanbeam=null;this.m_ActiveEdges=null;this.m_SortedEdges=null;this.DisposeAllPolyPts();for(var t=this.m_MinimaList;null!=t;){this.InsertScanbeam(t.y);this.InsertScanbeam(t.leftBound.ytop);t=t.next}};Kt.Clipper.prototype.get_ReverseSolution=function(){return this.m_ReverseOutput};Kt.Clipper.prototype.set_ReverseSolution=function(t){this.m_ReverseOutput=t};Kt.Clipper.prototype.InsertScanbeam=function(t){var e;if(null==this.m_Scanbeam){this.m_Scanbeam=new Kt.Scanbeam;this.m_Scanbeam.next=null;this.m_Scanbeam.y=t}else if(t>this.m_Scanbeam.y){e=new Kt.Scanbeam;e.y=t;e.next=this.m_Scanbeam;this.m_Scanbeam=e}else{for(var i=this.m_Scanbeam;null!=i.next&&t<=i.next.y;)i=i.next;if(t==i.y)return;e=new Kt.Scanbeam;e.y=t;e.next=i.next;i.next=e}};Kt.Clipper.prototype.Execute=function(t,e,i,n){var r;if(2==arguments.length){i=Kt.PolyFillType.pftEvenOdd;n=Kt.PolyFillType.pftEvenOdd}if(void 0===e.exPolygons){if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;Kt.Clear(e);this.m_SubjFillType=i;this.m_ClipFillType=n;this.m_ClipType=t;this.m_UsingExPolygons=!1;r=this.ExecuteInternal();r&&this.BuildResult(e);this.m_ExecuteLocked=!1;return r}if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0;Kt.Clear(e);this.m_SubjFillType=i;this.m_ClipFillType=n;this.m_ClipType=t;this.m_UsingExPolygons=!0;r=this.ExecuteInternal();r&&this.BuildResultEx(e);this.m_ExecuteLocked=!1;return r};Kt.Clipper.prototype.PolySort=function(t,e){if(t==e)return 0;if(null==t.pts||null==e.pts)return null==t.pts!=(null==e.pts)?null==t.pts?1:-1:0;var i,n;i=t.isHole?t.FirstLeft.idx:t.idx;n=e.isHole?e.FirstLeft.idx:e.idx;var r=i-n;return 0==r&&t.isHole!=e.isHole?t.isHole?1:-1:r};Kt.Clipper.prototype.FindAppendLinkEnd=function(t){for(;null!=t.AppendLink;)t=t.AppendLink;return t};Kt.Clipper.prototype.FixHoleLinkage=function(t){var e;e=null!=t.bottomPt?this.m_PolyOuts[t.bottomPt.idx].FirstLeft:t.FirstLeft;t==e&&Kt.Error("HoleLinkage error");if(null!=e){null!=e.AppendLink&&(e=this.FindAppendLinkEnd(e));if(e==t)e=null;else if(e.isHole){this.FixHoleLinkage(e);e=e.FirstLeft}}t.FirstLeft=e;null==e&&(t.isHole=!1);t.AppendLink=null};Kt.Clipper.prototype.ExecuteInternal=function(){var t;try{this.Reset();if(null==this.m_CurrentLM)return!0;var e=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(e);Kt.Clear(this.m_HorizJoins);this.ProcessHorizontals();var i=this.PopScanbeam();t=this.ProcessIntersections(e,i);if(!t)break;this.ProcessEdgesAtTopOfScanbeam(i);e=i}while(null!=this.m_Scanbeam)}catch(e){t=!1}if(t){for(var n,r=0;r<this.m_PolyOuts.length;r++){n=this.m_PolyOuts[r];if(null!=n.pts){this.FixupOutPolygon(n);if(null!=n.pts){n.isHole&&this.m_UsingExPolygons&&this.FixHoleLinkage(n);(n.isHole^this.m_ReverseOutput)==this.Area(n,this.m_UseFullRange)>0&&this.ReversePolyPtLinks(n.pts)}}}this.JoinCommonEdges();this.m_UsingExPolygons&&this.m_PolyOuts.sort(this.PolySort)}Kt.Clear(this.m_Joins);Kt.Clear(this.m_HorizJoins);return t};Kt.Clipper.prototype.PopScanbeam=function(){var t=this.m_Scanbeam.y;this.m_Scanbeam;this.m_Scanbeam=this.m_Scanbeam.next;null;return t};Kt.Clipper.prototype.DisposeAllPolyPts=function(){for(var t=0;t<this.m_PolyOuts.length;++t)this.DisposeOutRec(t);Kt.Clear(this.m_PolyOuts)};Kt.Clipper.prototype.DisposeOutRec=function(t){var e=this.m_PolyOuts[t];null!=e.pts&&this.DisposeOutPts(e.pts);e=null;this.m_PolyOuts[t]=null};Kt.Clipper.prototype.DisposeOutPts=function(t){if(null!=t){t.prev.next=null;for(;null!=t;){t;t=t.next;null}}};Kt.Clipper.prototype.AddJoin=function(t,e,i,n){var r=new Kt.JoinRec;r.poly1Idx=i>=0?i:t.outIdx;r.pt1a=new Kt.IntPoint(t.xcurr,t.ycurr);r.pt1b=new Kt.IntPoint(t.xtop,t.ytop);r.poly2Idx=n>=0?n:e.outIdx;r.pt2a=new Kt.IntPoint(e.xcurr,e.ycurr);r.pt2b=new Kt.IntPoint(e.xtop,e.ytop);this.m_Joins.push(r)};Kt.Clipper.prototype.AddHorzJoin=function(t,e){var i=new Kt.HorzJoinRec;i.edge=t;i.savedIdx=e;this.m_HorizJoins.push(i)};Kt.Clipper.prototype.InsertLocalMinimaIntoAEL=function(t){for(var e,i;null!=this.m_CurrentLM&&this.m_CurrentLM.y==t;){var n=this.m_CurrentLM.leftBound,r=this.m_CurrentLM.rightBound;this.InsertEdgeIntoAEL(n);this.InsertScanbeam(n.ytop);this.InsertEdgeIntoAEL(r);if(this.IsEvenOddFillType(n)){n.windDelta=1;r.windDelta=1}else r.windDelta=-n.windDelta;this.SetWindingCount(n);r.windCnt=n.windCnt;r.windCnt2=n.windCnt2;if(r.dx==Kt.ClipperBase.horizontal){this.AddEdgeToSEL(r);this.InsertScanbeam(r.nextInLML.ytop)}else this.InsertScanbeam(r.ytop);this.IsContributing(n)&&this.AddLocalMinPoly(n,r,new Kt.IntPoint(n.xcurr,this.m_CurrentLM.y));if(r.outIdx>=0&&r.dx==Kt.ClipperBase.horizontal)for(var o=0;o<this.m_HorizJoins.length;o++){e=new Kt.IntPoint,i=new Kt.IntPoint;var s=this.m_HorizJoins[o];(function(){e={Value:e};i={Value:i};var t=this.GetOverlapSegment(new Kt.IntPoint(s.edge.xbot,s.edge.ybot),new Kt.IntPoint(s.edge.xtop,s.edge.ytop),new Kt.IntPoint(r.xbot,r.ybot),new Kt.IntPoint(r.xtop,r.ytop),e,i);e=e.Value;i=i.Value;return t}).call(this)&&this.AddJoin(s.edge,r,s.savedIdx,-1)}if(n.nextInAEL!=r){r.outIdx>=0&&r.prevInAEL.outIdx>=0&&this.SlopesEqual(r.prevInAEL,r,this.m_UseFullRange)&&this.AddJoin(r,r.prevInAEL,-1,-1);var l=n.nextInAEL;e=new Kt.IntPoint(n.xcurr,n.ycurr);for(;l!=r;){null==l&&Kt.Error("InsertLocalMinimaIntoAEL: missing rightbound!");this.IntersectEdges(r,l,e,Kt.Protects.ipNone);l=l.nextInAEL}}this.PopLocalMinima()}};Kt.Clipper.prototype.InsertEdgeIntoAEL=function(t){t.prevInAEL=null;t.nextInAEL=null;if(null==this.m_ActiveEdges)this.m_ActiveEdges=t;else if(this.E2InsertsBeforeE1(this.m_ActiveEdges,t)){t.nextInAEL=this.m_ActiveEdges;this.m_ActiveEdges.prevInAEL=t;this.m_ActiveEdges=t}else{for(var e=this.m_ActiveEdges;null!=e.nextInAEL&&!this.E2InsertsBeforeE1(e.nextInAEL,t);)e=e.nextInAEL;t.nextInAEL=e.nextInAEL;null!=e.nextInAEL&&(e.nextInAEL.prevInAEL=t);t.prevInAEL=e;e.nextInAEL=t}};Kt.Clipper.prototype.E2InsertsBeforeE1=function(t,e){return e.xcurr==t.xcurr?e.dx>t.dx:e.xcurr<t.xcurr};Kt.Clipper.prototype.IsEvenOddFillType=function(t){return t.polyType==Kt.PolyType.ptSubject?this.m_SubjFillType==Kt.PolyFillType.pftEvenOdd:this.m_ClipFillType==Kt.PolyFillType.pftEvenOdd};Kt.Clipper.prototype.IsEvenOddAltFillType=function(t){return t.polyType==Kt.PolyType.ptSubject?this.m_ClipFillType==Kt.PolyFillType.pftEvenOdd:this.m_SubjFillType==Kt.PolyFillType.pftEvenOdd};Kt.Clipper.prototype.IsContributing=function(t){var e,i;if(t.polyType==Kt.PolyType.ptSubject){e=this.m_SubjFillType;i=this.m_ClipFillType}else{e=this.m_ClipFillType;i=this.m_SubjFillType}switch(e){case Kt.PolyFillType.pftEvenOdd:case Kt.PolyFillType.pftNonZero:if(1!=Kt.Math_Abs_Int32(t.windCnt))return!1;break;case Kt.PolyFillType.pftPositive:if(1!=t.windCnt)return!1;break;default:if(-1!=t.windCnt)return!1}switch(this.m_ClipType){case Kt.ClipType.ctIntersection:switch(i){case Kt.PolyFillType.pftEvenOdd:case Kt.PolyFillType.pftNonZero:return 0!=t.windCnt2;case Kt.PolyFillType.pftPositive:return t.windCnt2>0;default:return t.windCnt2<0}break;case Kt.ClipType.ctUnion:switch(i){case Kt.PolyFillType.pftEvenOdd:case Kt.PolyFillType.pftNonZero:return 0==t.windCnt2;case Kt.PolyFillType.pftPositive:return t.windCnt2<=0;default:return t.windCnt2>=0}break;case Kt.ClipType.ctDifference:if(t.polyType==Kt.PolyType.ptSubject)switch(i){case Kt.PolyFillType.pftEvenOdd:case Kt.PolyFillType.pftNonZero:return 0==t.windCnt2;case Kt.PolyFillType.pftPositive:return t.windCnt2<=0;default:return t.windCnt2>=0}else switch(i){case Kt.PolyFillType.pftEvenOdd:case Kt.PolyFillType.pftNonZero:return 0!=t.windCnt2;case Kt.PolyFillType.pftPositive:return t.windCnt2>0;default:return t.windCnt2<0}}return!0};Kt.Clipper.prototype.SetWindingCount=function(t){for(var e=t.prevInAEL;null!=e&&e.polyType!=t.polyType;)e=e.prevInAEL;if(null==e){t.windCnt=t.windDelta;t.windCnt2=0;e=this.m_ActiveEdges}else if(this.IsEvenOddFillType(t)){t.windCnt=1;t.windCnt2=e.windCnt2;e=e.nextInAEL}else{e.windCnt*e.windDelta<0?Kt.Math_Abs_Int32(e.windCnt)>1?e.windDelta*t.windDelta<0?t.windCnt=e.windCnt:t.windCnt=e.windCnt+t.windDelta:t.windCnt=e.windCnt+e.windDelta+t.windDelta:Kt.Math_Abs_Int32(e.windCnt)>1&&e.windDelta*t.windDelta<0?t.windCnt=e.windCnt:e.windCnt+t.windDelta==0?t.windCnt=e.windCnt:t.windCnt=e.windCnt+t.windDelta;t.windCnt2=e.windCnt2;e=e.nextInAEL}if(this.IsEvenOddAltFillType(t))for(;e!=t;){t.windCnt2=0==t.windCnt2?1:0;e=e.nextInAEL}else for(;e!=t;){t.windCnt2+=e.windDelta;e=e.nextInAEL}};Kt.Clipper.prototype.AddEdgeToSEL=function(t){if(null==this.m_SortedEdges){this.m_SortedEdges=t;t.prevInSEL=null;t.nextInSEL=null}else{t.nextInSEL=this.m_SortedEdges;t.prevInSEL=null;this.m_SortedEdges.prevInSEL=t;this.m_SortedEdges=t}};Kt.Clipper.prototype.CopyAELToSEL=function(){var t=this.m_ActiveEdges;this.m_SortedEdges=t;if(null!=this.m_ActiveEdges){this.m_SortedEdges.prevInSEL=null;t=t.nextInAEL;for(;null!=t;){t.prevInSEL=t.prevInAEL;t.prevInSEL.nextInSEL=t;t.nextInSEL=null;t=t.nextInAEL}}};Kt.Clipper.prototype.SwapPositionsInAEL=function(t,e){var i,n;if(!(null==t.nextInAEL&&null==t.prevInAEL||null==e.nextInAEL&&null==e.prevInAEL)){if(t.nextInAEL==e){i=e.nextInAEL;null!=i&&(i.prevInAEL=t);n=t.prevInAEL;null!=n&&(n.nextInAEL=e);e.prevInAEL=n;e.nextInAEL=t;t.prevInAEL=e;t.nextInAEL=i}else if(e.nextInAEL==t){i=t.nextInAEL;null!=i&&(i.prevInAEL=e);n=e.prevInAEL;null!=n&&(n.nextInAEL=t);t.prevInAEL=n;t.nextInAEL=e;e.prevInAEL=t;e.nextInAEL=i}else{i=t.nextInAEL;n=t.prevInAEL;t.nextInAEL=e.nextInAEL;null!=t.nextInAEL&&(t.nextInAEL.prevInAEL=t);t.prevInAEL=e.prevInAEL;null!=t.prevInAEL&&(t.prevInAEL.nextInAEL=t);e.nextInAEL=i;null!=e.nextInAEL&&(e.nextInAEL.prevInAEL=e);e.prevInAEL=n;null!=e.prevInAEL&&(e.prevInAEL.nextInAEL=e)}null==t.prevInAEL?this.m_ActiveEdges=t:null==e.prevInAEL&&(this.m_ActiveEdges=e)}};Kt.Clipper.prototype.SwapPositionsInSEL=function(t,e){var i,n;if(!(null==t.nextInSEL&&null==t.prevInSEL||null==e.nextInSEL&&null==e.prevInSEL)){if(t.nextInSEL==e){i=e.nextInSEL;null!=i&&(i.prevInSEL=t);n=t.prevInSEL;null!=n&&(n.nextInSEL=e);e.prevInSEL=n;e.nextInSEL=t;t.prevInSEL=e;t.nextInSEL=i}else if(e.nextInSEL==t){i=t.nextInSEL;null!=i&&(i.prevInSEL=e);n=e.prevInSEL;null!=n&&(n.nextInSEL=t);t.prevInSEL=n;t.nextInSEL=e;e.prevInSEL=t;e.nextInSEL=i}else{i=t.nextInSEL;n=t.prevInSEL;t.nextInSEL=e.nextInSEL;null!=t.nextInSEL&&(t.nextInSEL.prevInSEL=t);t.prevInSEL=e.prevInSEL;null!=t.prevInSEL&&(t.prevInSEL.nextInSEL=t);e.nextInSEL=i;null!=e.nextInSEL&&(e.nextInSEL.prevInSEL=e);e.prevInSEL=n;null!=e.prevInSEL&&(e.prevInSEL.nextInSEL=e)}null==t.prevInSEL?this.m_SortedEdges=t:null==e.prevInSEL&&(this.m_SortedEdges=e)}};Kt.Clipper.prototype.AddLocalMaxPoly=function(t,e,i){this.AddOutPt(t,i);if(t.outIdx==e.outIdx){t.outIdx=-1;e.outIdx=-1}else t.outIdx<e.outIdx?this.AppendPolygon(t,e):this.AppendPolygon(e,t)};Kt.Clipper.prototype.AddLocalMinPoly=function(t,e,i){var n,r;if(e.dx==Kt.ClipperBase.horizontal||t.dx>e.dx){this.AddOutPt(t,i);e.outIdx=t.outIdx;t.side=Kt.EdgeSide.esLeft;e.side=Kt.EdgeSide.esRight;n=t;r=n.prevInAEL==e?e.prevInAEL:n.prevInAEL}else{this.AddOutPt(e,i);t.outIdx=e.outIdx;t.side=Kt.EdgeSide.esRight;e.side=Kt.EdgeSide.esLeft;n=e;r=n.prevInAEL==t?t.prevInAEL:n.prevInAEL}null!=r&&r.outIdx>=0&&Kt.Clipper.TopX(r,i.y)==Kt.Clipper.TopX(n,i.y)&&this.SlopesEqual(n,r,this.m_UseFullRange)&&this.AddJoin(n,r,-1,-1)};Kt.Clipper.prototype.CreateOutRec=function(){var t=new Kt.OutRec;t.idx=-1;t.isHole=!1;t.FirstLeft=null;t.AppendLink=null;t.pts=null;t.bottomPt=null;return t};Kt.Clipper.prototype.AddOutPt=function(t,e){var i,n,r=t.side==Kt.EdgeSide.esLeft;if(t.outIdx<0){i=this.CreateOutRec();this.m_PolyOuts.push(i);i.idx=this.m_PolyOuts.length-1;t.outIdx=i.idx;n=new Kt.OutPt;i.pts=n;i.bottomPt=n;n.pt=e;n.idx=i.idx;n.next=n;n.prev=n;this.SetHoleState(t,i)}else{i=this.m_PolyOuts[t.outIdx];n=i.pts;var o;if(r&&Kt.ClipperBase.PointsEqual(e,n.pt)||!r&&Kt.ClipperBase.PointsEqual(e,n.prev.pt))return;o=new Kt.OutPt;o.pt=e;o.idx=i.idx;o.pt.y==i.bottomPt.pt.y&&o.pt.x<i.bottomPt.pt.x&&(i.bottomPt=o);o.next=n;o.prev=n.prev;o.prev.next=o;n.prev=o;r&&(i.pts=o)}};Kt.Clipper.prototype.SwapPoints=function(t,e){var i=t.Value;t.Value=e.Value;e.Value=i};Kt.Clipper.prototype.GetOverlapSegment=function(t,e,i,n,r,o){if(Kt.Math_Abs_Int64(t.x-e.x)>Kt.Math_Abs_Int64(t.y-e.y)){t.x>e.x&&function(){t={Value:t};e={Value:e};var i=this.SwapPoints(t,e);t=t.Value;e=e.Value;return i}.call(this);i.x>n.x&&function(){i={Value:i};n={Value:n};var t=this.SwapPoints(i,n);i=i.Value;n=n.Value;return t}.call(this);t.x>i.x?r.Value=t:r.Value=i;e.x<n.x?o.Value=e:o.Value=n;return r.Value.x<o.Value.x}t.y<e.y&&function(){t={Value:t};e={Value:e};var i=this.SwapPoints(t,e);t=t.Value;e=e.Value;return i}.call(this);i.y<n.y&&function(){i={Value:i};n={Value:n};var t=this.SwapPoints(i,n);i=i.Value;n=n.Value;return t}.call(this);t.y<i.y?r.Value=t:r.Value=i;e.y>n.y?o.Value=e:o.Value=n;return r.Value.y>o.Value.y};Kt.Clipper.prototype.FindSegment=function(t,e,i,n){if(null==t.Value)return!1;var r=t.Value,o=new Kt.IntPoint(i.Value),s=new Kt.IntPoint(n.Value);do{if(this.SlopesEqual(o,s,t.Value.pt,t.Value.prev.pt,e)&&this.SlopesEqual(o,s,t.Value.pt,e)&&this.GetOverlapSegment(o,s,t.Value.pt,t.Value.prev.pt,i,n))return!0;t.Value=t.Value.next}while(t.Value!=r);return!1};Kt.Clipper.prototype.Pt3IsBetweenPt1AndPt2=function(t,e,i){return!(!Kt.ClipperBase.PointsEqual(t,i)&&!Kt.ClipperBase.PointsEqual(e,i))||(t.x!=e.x?t.x<i.x==i.x<e.x:t.y<i.y==i.y<e.y)};Kt.Clipper.prototype.InsertPolyPtBetween=function(t,e,i){var n=new Kt.OutPt;n.pt=i;if(e==t.next){t.next=n;e.prev=n;n.next=e;n.prev=t}else{e.next=n;t.prev=n;n.next=t;n.prev=e}return n};Kt.Clipper.prototype.SetHoleState=function(t,e){for(var i=!1,n=t.prevInAEL;null!=n;){if(n.outIdx>=0){i=!i;null==e.FirstLeft&&(e.FirstLeft=this.m_PolyOuts[n.outIdx])}n=n.prevInAEL}i&&(e.isHole=!0)};Kt.Clipper.prototype.GetDx=function(t,e){return t.y==e.y?Kt.ClipperBase.horizontal:(e.x-t.x)/(e.y-t.y)};Kt.Clipper.prototype.FirstIsBottomPt=function(t,e){for(var i=t.prev;Kt.ClipperBase.PointsEqual(i.pt,t.pt)&&i!=t;)i=i.prev;var n=Kt.Math_Abs_Double(this.GetDx(t.pt,i.pt));i=t.next;for(;Kt.ClipperBase.PointsEqual(i.pt,t.pt)&&i!=t;)i=i.next;var r=Kt.Math_Abs_Double(this.GetDx(t.pt,i.pt));i=e.prev;for(;Kt.ClipperBase.PointsEqual(i.pt,e.pt)&&i!=e;)i=i.prev;var o=Kt.Math_Abs_Double(this.GetDx(e.pt,i.pt));i=e.next;for(;Kt.ClipperBase.PointsEqual(i.pt,e.pt)&&i!=e;)i=i.next;var s=Kt.Math_Abs_Double(this.GetDx(e.pt,i.pt));return n>=o&&n>=s||r>=o&&r>=s};Kt.Clipper.prototype.GetBottomPt=function(t){for(var e=null,i=t.next;i!=t;){if(i.pt.y>t.pt.y){t=i;e=null}else if(i.pt.y==t.pt.y&&i.pt.x<=t.pt.x)if(i.pt.x<t.pt.x){e=null;t=i}else i.next!=t&&i.prev!=t&&(e=i);i=i.next}if(null!=e)for(;e!=i;){this.FirstIsBottomPt(i,e)||(t=e);e=e.next;for(;!Kt.ClipperBase.PointsEqual(e.pt,t.pt);)e=e.next}return t};Kt.Clipper.prototype.GetLowermostRec=function(t,e){var i=t.bottomPt,n=e.bottomPt;return i.pt.y>n.pt.y?t:i.pt.y<n.pt.y?e:i.pt.x<n.pt.x?t:i.pt.x>n.pt.x?e:i.next==i?e:n.next==n?t:this.FirstIsBottomPt(i,n)?t:e};Kt.Clipper.prototype.Param1RightOfParam2=function(t,e){do{t=t.FirstLeft;if(t==e)return!0}while(null!=t);return!1};Kt.Clipper.prototype.AppendPolygon=function(t,e){var i,n=this.m_PolyOuts[t.outIdx],r=this.m_PolyOuts[e.outIdx];i=this.Param1RightOfParam2(n,r)?r:this.Param1RightOfParam2(r,n)?n:this.GetLowermostRec(n,r);var o,s,l=n.pts,p=l.prev,h=r.pts,a=h.prev;if(t.side==Kt.EdgeSide.esLeft){if(e.side==Kt.EdgeSide.esLeft){this.ReversePolyPtLinks(h);h.next=l;l.prev=h;p.next=a;a.prev=p;n.pts=a}else{a.next=l;l.prev=a;h.prev=p;p.next=h;n.pts=h}o=Kt.EdgeSide.esLeft}else{if(e.side==Kt.EdgeSide.esRight){this.ReversePolyPtLinks(h);p.next=a;a.prev=p;h.next=l;l.prev=h}else{p.next=h;h.prev=p;l.prev=a;a.next=l}o=Kt.EdgeSide.esRight}if(i==r){n.bottomPt=r.bottomPt;n.bottomPt.idx=n.idx;r.FirstLeft!=n&&(n.FirstLeft=r.FirstLeft);n.isHole=r.isHole}r.pts=null;r.bottomPt=null;r.AppendLink=n;var u=t.outIdx,f=e.outIdx;t.outIdx=-1;e.outIdx=-1;for(var d=this.m_ActiveEdges;null!=d;){if(d.outIdx==f){d.outIdx=u;d.side=o;break}d=d.nextInAEL}for(s=0;s<this.m_Joins.length;++s){this.m_Joins[s].poly1Idx==f&&(this.m_Joins[s].poly1Idx=u);this.m_Joins[s].poly2Idx==f&&(this.m_Joins[s].poly2Idx=u)}for(s=0;s<this.m_HorizJoins.length;++s)this.m_HorizJoins[s].savedIdx==f&&(this.m_HorizJoins[s].savedIdx=u)};Kt.Clipper.prototype.ReversePolyPtLinks=function(t){if(null!=t){var e,i;e=t;do{i=e.next;e.next=e.prev;e.prev=i;e=i}while(e!=t)}};Kt.Clipper.SwapSides=function(t,e){var i=t.side;t.side=e.side;e.side=i};Kt.Clipper.SwapPolyIndexes=function(t,e){var i=t.outIdx;t.outIdx=e.outIdx;e.outIdx=i};Kt.Clipper.prototype.DoEdge1=function(t,e,i){this.AddOutPt(t,i);Kt.Clipper.SwapSides(t,e);Kt.Clipper.SwapPolyIndexes(t,e)};Kt.Clipper.prototype.DoEdge2=function(t,e,i){this.AddOutPt(e,i);Kt.Clipper.SwapSides(t,e);Kt.Clipper.SwapPolyIndexes(t,e)};Kt.Clipper.prototype.DoBothEdges=function(t,e,i){this.AddOutPt(t,i);this.AddOutPt(e,i);Kt.Clipper.SwapSides(t,e);Kt.Clipper.SwapPolyIndexes(t,e)};Kt.Clipper.prototype.IntersectEdges=function(t,e,i,n){var r=0==(Kt.Protects.ipLeft&n)&&null==t.nextInLML&&t.xtop==i.x&&t.ytop==i.y,o=0==(Kt.Protects.ipRight&n)&&null==e.nextInLML&&e.xtop==i.x&&e.ytop==i.y,s=t.outIdx>=0,l=e.outIdx>=0;if(t.polyType==e.polyType)if(this.IsEvenOddFillType(t)){var p=t.windCnt;t.windCnt=e.windCnt;e.windCnt=p}else{t.windCnt+e.windDelta==0?t.windCnt=-t.windCnt:t.windCnt+=e.windDelta;e.windCnt-t.windDelta==0?e.windCnt=-e.windCnt:e.windCnt-=t.windDelta}else{this.IsEvenOddFillType(e)?t.windCnt2=0==t.windCnt2?1:0:t.windCnt2+=e.windDelta;this.IsEvenOddFillType(t)?e.windCnt2=0==e.windCnt2?1:0:e.windCnt2-=t.windDelta}var h,a,u,f;if(t.polyType==Kt.PolyType.ptSubject){h=this.m_SubjFillType;u=this.m_ClipFillType}else{h=this.m_ClipFillType;u=this.m_SubjFillType}if(e.polyType==Kt.PolyType.ptSubject){a=this.m_SubjFillType;f=this.m_ClipFillType}else{a=this.m_ClipFillType;f=this.m_SubjFillType}var d,y;switch(h){case Kt.PolyFillType.pftPositive:d=t.windCnt;break;case Kt.PolyFillType.pftNegative:d=-t.windCnt;break;default:d=Kt.Math_Abs_Int32(t.windCnt)}switch(a){case Kt.PolyFillType.pftPositive:y=e.windCnt;break;case Kt.PolyFillType.pftNegative:y=-e.windCnt;break;default:y=Kt.Math_Abs_Int32(e.windCnt)}if(s&&l)r||o||0!=d&&1!=d||0!=y&&1!=y||t.polyType!=e.polyType&&this.m_ClipType!=Kt.ClipType.ctXor?this.AddLocalMaxPoly(t,e,i):this.DoBothEdges(t,e,i);else if(s)0!=y&&1!=y||this.m_ClipType==Kt.ClipType.ctIntersection&&e.polyType!=Kt.PolyType.ptSubject&&0==e.windCnt2||this.DoEdge1(t,e,i);else if(l)0!=d&&1!=d||this.m_ClipType==Kt.ClipType.ctIntersection&&t.polyType!=Kt.PolyType.ptSubject&&0==t.windCnt2||this.DoEdge2(t,e,i);else if(!(0!=d&&1!=d||0!=y&&1!=y||r||o)){var c,m;switch(u){case Kt.PolyFillType.pftPositive:c=t.windCnt2;break;case Kt.PolyFillType.pftNegative:c=-t.windCnt2;break;default:c=Kt.Math_Abs_Int32(t.windCnt2)}switch(f){case Kt.PolyFillType.pftPositive:m=e.windCnt2;break;case Kt.PolyFillType.pftNegative:m=-e.windCnt2;break;default:m=Kt.Math_Abs_Int32(e.windCnt2)}if(t.polyType!=e.polyType)this.AddLocalMinPoly(t,e,i);else if(1==d&&1==y)switch(this.m_ClipType){case Kt.ClipType.ctIntersection:c>0&&m>0&&this.AddLocalMinPoly(t,e,i);break;case Kt.ClipType.ctUnion:c<=0&&m<=0&&this.AddLocalMinPoly(t,e,i);break;case Kt.ClipType.ctDifference:(t.polyType==Kt.PolyType.ptClip&&c>0&&m>0||t.polyType==Kt.PolyType.ptSubject&&c<=0&&m<=0)&&this.AddLocalMinPoly(t,e,i);break;case Kt.ClipType.ctXor:this.AddLocalMinPoly(t,e,i)}else Kt.Clipper.SwapSides(t,e)}if(r!=o&&(r&&t.outIdx>=0||o&&e.outIdx>=0)){Kt.Clipper.SwapSides(t,e);Kt.Clipper.SwapPolyIndexes(t,e)}r&&this.DeleteFromAEL(t);o&&this.DeleteFromAEL(e)};Kt.Clipper.prototype.DeleteFromAEL=function(t){var e=t.prevInAEL,i=t.nextInAEL;if(null!=e||null!=i||t==this.m_ActiveEdges){null!=e?e.nextInAEL=i:this.m_ActiveEdges=i;null!=i&&(i.prevInAEL=e);t.nextInAEL=null;t.prevInAEL=null}};Kt.Clipper.prototype.DeleteFromSEL=function(t){var e=t.prevInSEL,i=t.nextInSEL;if(null!=e||null!=i||t==this.m_SortedEdges){null!=e?e.nextInSEL=i:this.m_SortedEdges=i;null!=i&&(i.prevInSEL=e);t.nextInSEL=null;t.prevInSEL=null}};Kt.Clipper.prototype.UpdateEdgeIntoAEL=function(t){null==t.Value.nextInLML&&Kt.Error("UpdateEdgeIntoAEL: invalid call");var e=t.Value.prevInAEL,i=t.Value.nextInAEL;t.Value.nextInLML.outIdx=t.Value.outIdx;null!=e?e.nextInAEL=t.Value.nextInLML:this.m_ActiveEdges=t.Value.nextInLML;null!=i&&(i.prevInAEL=t.Value.nextInLML);t.Value.nextInLML.side=t.Value.side;t.Value.nextInLML.windDelta=t.Value.windDelta;t.Value.nextInLML.windCnt=t.Value.windCnt;t.Value.nextInLML.windCnt2=t.Value.windCnt2;t.Value=t.Value.nextInLML;t.Value.prevInAEL=e;t.Value.nextInAEL=i;t.Value.dx!=Kt.ClipperBase.horizontal&&this.InsertScanbeam(t.Value.ytop)};Kt.Clipper.prototype.ProcessHorizontals=function(){for(var t=this.m_SortedEdges;null!=t;){this.DeleteFromSEL(t);this.ProcessHorizontal(t);t=this.m_SortedEdges}};Kt.Clipper.prototype.ProcessHorizontal=function(t){var e,i,n;if(t.xcurr<t.xtop){i=t.xcurr;n=t.xtop;e=Kt.Direction.dLeftToRight}else{i=t.xtop;n=t.xcurr;e=Kt.Direction.dRightToLeft}var r;r=null!=t.nextInLML?null:this.GetMaximaPair(t);for(var o=this.GetNextInAEL(t,e);null!=o;){var s=this.GetNextInAEL(o,e);if(null!=r||e==Kt.Direction.dLeftToRight&&o.xcurr<=n||e==Kt.Direction.dRightToLeft&&o.xcurr>=i){if(o.xcurr==t.xtop&&null==r){if(this.SlopesEqual(o,t.nextInLML,this.m_UseFullRange)){t.outIdx>=0&&o.outIdx>=0&&this.AddJoin(t.nextInLML,o,t.outIdx,-1);break}if(o.dx<t.nextInLML.dx)break}if(o==r){e==Kt.Direction.dLeftToRight?this.IntersectEdges(t,o,new Kt.IntPoint(o.xcurr,t.ycurr),0):this.IntersectEdges(o,t,new Kt.IntPoint(o.xcurr,t.ycurr),0);r.outIdx>=0&&Kt.Error("ProcessHorizontal error");return}o.dx!=Kt.ClipperBase.horizontal||this.IsMinima(o)||(o.xcurr,o.xtop),e==Kt.Direction.dLeftToRight?this.IntersectEdges(t,o,new Kt.IntPoint(o.xcurr,t.ycurr),this.IsTopHorz(t,o.xcurr)?Kt.Protects.ipLeft:Kt.Protects.ipBoth):this.IntersectEdges(o,t,new Kt.IntPoint(o.xcurr,t.ycurr),this.IsTopHorz(t,o.xcurr)?Kt.Protects.ipRight:Kt.Protects.ipBoth);this.SwapPositionsInAEL(t,o)}else if(e==Kt.Direction.dLeftToRight&&o.xcurr>n&&null==t.nextInSEL||e==Kt.Direction.dRightToLeft&&o.xcurr<i&&null==t.nextInSEL)break;o=s}if(null!=t.nextInLML){t.outIdx>=0&&this.AddOutPt(t,new Kt.IntPoint(t.xtop,t.ytop));(function(){t={Value:t};var e=this.UpdateEdgeIntoAEL(t);t=t.Value;return e}).call(this)}else{t.outIdx>=0&&this.IntersectEdges(t,r,new Kt.IntPoint(t.xtop,t.ycurr),Kt.Protects.ipBoth);this.DeleteFromAEL(r);this.DeleteFromAEL(t)}};Kt.Clipper.prototype.IsTopHorz=function(t,e){for(var i=this.m_SortedEdges;null!=i;){if(e>=Math.min(i.xcurr,i.xtop)&&e<=Math.max(i.xcurr,i.xtop))return!1;i=i.nextInSEL}return!0};Kt.Clipper.prototype.GetNextInAEL=function(t,e){return e==Kt.Direction.dLeftToRight?t.nextInAEL:t.prevInAEL};Kt.Clipper.prototype.IsMinima=function(t){return null!=t&&t.prev.nextInLML!=t&&t.next.nextInLML!=t};Kt.Clipper.prototype.IsMaxima=function(t,e){return null!=t&&t.ytop==e&&null==t.nextInLML};Kt.Clipper.prototype.IsIntermediate=function(t,e){return t.ytop==e&&null!=t.nextInLML};Kt.Clipper.prototype.GetMaximaPair=function(t){return this.IsMaxima(t.next,t.ytop)&&t.next.xtop==t.xtop?t.next:t.prev};Kt.Clipper.prototype.ProcessIntersections=function(t,e){if(null==this.m_ActiveEdges)return!0;try{this.BuildIntersectList(t,e);if(null==this.m_IntersectNodes)return!0;if(!this.FixupIntersections())return!1;this.ProcessIntersectList()}catch(t){this.m_SortedEdges=null;this.DisposeIntersectNodes();Kt.Error("ProcessIntersections error")}return!0};Kt.Clipper.prototype.BuildIntersectList=function(t,e){if(null!=this.m_ActiveEdges){var i=this.m_ActiveEdges;i.tmpX=Kt.Clipper.TopX(i,e);this.m_SortedEdges=i;this.m_SortedEdges.prevInSEL=null;i=i.nextInAEL;for(;null!=i;){i.prevInSEL=i.prevInAEL;i.prevInSEL.nextInSEL=i;i.nextInSEL=null;i.tmpX=Kt.Clipper.TopX(i,e);i=i.nextInAEL}for(var n=!0;n&&null!=this.m_SortedEdges;){n=!1;i=this.m_SortedEdges;for(;null!=i.nextInSEL;){var r=i.nextInSEL,o=new Kt.IntPoint;if(i.tmpX>r.tmpX&&function(){o={Value:o};var t=this.IntersectPoint(i,r,o);o=o.Value;return t}.call(this)){if(o.y>t){o.y=t;o.x=Kt.Clipper.TopX(i,o.y)}this.AddIntersectNode(i,r,o);this.SwapPositionsInSEL(i,r);n=!0}else i=r}if(null==i.prevInSEL)break;i.prevInSEL.nextInSEL=null}this.m_SortedEdges=null}};Kt.Clipper.prototype.FixupIntersections=function(){if(null==this.m_IntersectNodes.next)return!0;this.CopyAELToSEL();for(var t=this.m_IntersectNodes,e=this.m_IntersectNodes.next;null!=e;){var i,n=t.edge1;if(n.prevInSEL==t.edge2)i=n.prevInSEL;else if(n.nextInSEL==t.edge2)i=n.nextInSEL;else{for(;null!=e&&e.edge1.nextInSEL!=e.edge2&&e.edge1.prevInSEL!=e.edge2;)e=e.next;if(null==e)return!1;this.SwapIntersectNodes(t,e);n=t.edge1;i=t.edge2}this.SwapPositionsInSEL(n,i);t=t.next;e=t.next}this.m_SortedEdges=null;return t.edge1.prevInSEL==t.edge2||t.edge1.nextInSEL==t.edge2};Kt.Clipper.prototype.ProcessIntersectList=function(){for(;null!=this.m_IntersectNodes;){var t=this.m_IntersectNodes.next;this.IntersectEdges(this.m_IntersectNodes.edge1,this.m_IntersectNodes.edge2,this.m_IntersectNodes.pt,Kt.Protects.ipBoth);this.SwapPositionsInAEL(this.m_IntersectNodes.edge1,this.m_IntersectNodes.edge2);this.m_IntersectNodes=null;this.m_IntersectNodes=t}};var ae=function(t){
return t<0?Math.ceil(t-.5):Math.round(t)},ue=function(t){return t<0?Math.ceil(t-.5):Math.floor(t+.5)},fe=function(t){return t<0?-Math.round(Math.abs(t)):Math.round(t)},de=function(t){if(t<0){t-=.5;return t<-2147483648?Math.ceil(t):0|t}t+=.5;return t>2147483647?Math.floor(t):0|t};ie.msie?Kt.Clipper.Round=ae:ie.chromium?Kt.Clipper.Round=fe:ie.safari?Kt.Clipper.Round=de:Kt.Clipper.Round=ue;Kt.Clipper.TopX=function(t,e){return e==t.ytop?t.xtop:t.xbot+Kt.Clipper.Round(t.dx*(e-t.ybot))};Kt.Clipper.prototype.AddIntersectNode=function(t,e,i){var n=new Kt.IntersectNode;n.edge1=t;n.edge2=e;n.pt=i;n.next=null;if(null==this.m_IntersectNodes)this.m_IntersectNodes=n;else if(this.ProcessParam1BeforeParam2(n,this.m_IntersectNodes)){n.next=this.m_IntersectNodes;this.m_IntersectNodes=n}else{for(var r=this.m_IntersectNodes;null!=r.next&&this.ProcessParam1BeforeParam2(r.next,n);)r=r.next;n.next=r.next;r.next=n}};Kt.Clipper.prototype.ProcessParam1BeforeParam2=function(t,e){var i;if(t.pt.y==e.pt.y){if(t.edge1==e.edge1||t.edge2==e.edge1){i=e.pt.x>t.pt.x;return e.edge1.dx>0?!i:i}if(t.edge1==e.edge2||t.edge2==e.edge2){i=e.pt.x>t.pt.x;return e.edge2.dx>0?!i:i}return e.pt.x>t.pt.x}return t.pt.y>e.pt.y};Kt.Clipper.prototype.SwapIntersectNodes=function(t,e){var i=t.edge1,n=t.edge2,r=t.pt;t.edge1=e.edge1;t.edge2=e.edge2;t.pt=e.pt;e.edge1=i;e.edge2=n;e.pt=r};Kt.Clipper.prototype.IntersectPoint=function(t,e,i){var n,r;if(this.SlopesEqual(t,e,this.m_UseFullRange))return!1;if(0==t.dx){i.Value.x=t.xbot;if(e.dx==Kt.ClipperBase.horizontal)i.Value.y=e.ybot;else{r=e.ybot-e.xbot/e.dx;i.Value.y=Kt.Clipper.Round(i.Value.x/e.dx+r)}}else if(0==e.dx){i.Value.x=e.xbot;if(t.dx==Kt.ClipperBase.horizontal)i.Value.y=t.ybot;else{n=t.ybot-t.xbot/t.dx;i.Value.y=Kt.Clipper.Round(i.Value.x/t.dx+n)}}else{n=t.xbot-t.ybot*t.dx;r=e.xbot-e.ybot*e.dx;var o=(r-n)/(t.dx-e.dx);i.Value.y=Kt.Clipper.Round(o);Kt.Math_Abs_Double(t.dx)<Kt.Math_Abs_Double(e.dx)?i.Value.x=Kt.Clipper.Round(t.dx*o+n):i.Value.x=Kt.Clipper.Round(e.dx*o+r)}if(i.Value.y<t.ytop||i.Value.y<e.ytop){if(t.ytop>e.ytop){i.Value.x=t.xtop;i.Value.y=t.ytop;return Kt.Clipper.TopX(e,t.ytop)<t.xtop}i.Value.x=e.xtop;i.Value.y=e.ytop;return Kt.Clipper.TopX(t,e.ytop)>e.xtop}return!0};Kt.Clipper.prototype.DisposeIntersectNodes=function(){for(;null!=this.m_IntersectNodes;){var t=this.m_IntersectNodes.next;this.m_IntersectNodes=null;this.m_IntersectNodes=t}};Kt.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(t){for(var e,i=this.m_ActiveEdges;null!=i;)if(this.IsMaxima(i,t)&&this.GetMaximaPair(i).dx!=Kt.ClipperBase.horizontal){e=i.prevInAEL;this.DoMaxima(i,t);i=null==e?this.m_ActiveEdges:e.nextInAEL}else{if(this.IsIntermediate(i,t)&&i.nextInLML.dx==Kt.ClipperBase.horizontal){if(i.outIdx>=0){this.AddOutPt(i,new Kt.IntPoint(i.xtop,i.ytop));for(var n=0;n<this.m_HorizJoins.length;++n){var r=new Kt.IntPoint,o=new Kt.IntPoint,s=this.m_HorizJoins[n];(function(){r={Value:r};o={Value:o};var t=this.GetOverlapSegment(new Kt.IntPoint(s.edge.xbot,s.edge.ybot),new Kt.IntPoint(s.edge.xtop,s.edge.ytop),new Kt.IntPoint(i.nextInLML.xbot,i.nextInLML.ybot),new Kt.IntPoint(i.nextInLML.xtop,i.nextInLML.ytop),r,o);r=r.Value;o=o.Value;return t}).call(this)&&this.AddJoin(s.edge,i.nextInLML,s.savedIdx,i.outIdx)}this.AddHorzJoin(i.nextInLML,i.outIdx)}(function(){i={Value:i};var t=this.UpdateEdgeIntoAEL(i);i=i.Value;return t}).call(this);this.AddEdgeToSEL(i)}else{i.xcurr=Kt.Clipper.TopX(i,t);i.ycurr=t}i=i.nextInAEL}this.ProcessHorizontals();i=this.m_ActiveEdges;for(;null!=i;){if(this.IsIntermediate(i,t)){i.outIdx>=0&&this.AddOutPt(i,new Kt.IntPoint(i.xtop,i.ytop));(function(){i={Value:i};var t=this.UpdateEdgeIntoAEL(i);i=i.Value;return t}).call(this);e=i.prevInAEL;var l=i.nextInAEL;if(null!=e&&e.xcurr==i.xbot&&e.ycurr==i.ybot&&i.outIdx>=0&&e.outIdx>=0&&e.ycurr>e.ytop&&this.SlopesEqual(i,e,this.m_UseFullRange)){this.AddOutPt(e,new Kt.IntPoint(i.xbot,i.ybot));this.AddJoin(i,e,-1,-1)}else if(null!=l&&l.xcurr==i.xbot&&l.ycurr==i.ybot&&i.outIdx>=0&&l.outIdx>=0&&l.ycurr>l.ytop&&this.SlopesEqual(i,l,this.m_UseFullRange)){this.AddOutPt(l,new Kt.IntPoint(i.xbot,i.ybot));this.AddJoin(i,l,-1,-1)}}i=i.nextInAEL}};Kt.Clipper.prototype.DoMaxima=function(t,e){for(var i=this.GetMaximaPair(t),n=t.xtop,r=t.nextInAEL;r!=i;){null==r&&Kt.Error("DoMaxima error");this.IntersectEdges(t,r,new Kt.IntPoint(n,e),Kt.Protects.ipBoth);r=r.nextInAEL}if(t.outIdx<0&&i.outIdx<0){this.DeleteFromAEL(t);this.DeleteFromAEL(i)}else t.outIdx>=0&&i.outIdx>=0?this.IntersectEdges(t,i,new Kt.IntPoint(n,e),Kt.Protects.ipNone):Kt.Error("DoMaxima error")};Kt.Clipper.ReversePolygons=function(t){for(var e=t.length,i=0;i<e;i++)Array.isArray(t[i])&&t[i].reverse()};Kt.Clipper.Orientation=function(t){return this.Area(t)>=0};Kt.Clipper.prototype.PointCount=function(t){if(null==t)return 0;var e=0,i=t;do{e++;i=i.next}while(i!=t);return e};Kt.Clipper.prototype.BuildResult=function(t){Kt.Clear(t);for(var e,i=this.m_PolyOuts.length,n=0;n<i;n++){e=this.m_PolyOuts[n];if(null!=e.pts){var r=e.pts,o=this.PointCount(r);if(!(o<3)){for(var s=new Kt.Polygon(o),l=0;l<o;l++){s.push(new Kt.IntPoint(r.pt.x,r.pt.y));r=r.prev}t.push(s)}}}};Kt.Clipper.prototype.BuildResultEx=function(t){Kt.Clear(t);for(var e=0;e<this.m_PolyOuts.length;){var i=this.m_PolyOuts[e++];if(null==i.pts)break;var n=i.pts,r=this.PointCount(n);if(!(r<3)){var o=new Kt.ExPolygon;o.outer=new Kt.Polygon;o.holes=new Kt.Polygons;for(var s=0;s<r;s++){o.outer.push(new Kt.IntPoint(n.pt.x,n.pt.y));n=n.prev}for(;e<this.m_PolyOuts.length;){i=this.m_PolyOuts[e];if(null==i.pts||!i.isHole)break;var l=new Kt.Polygon;n=i.pts;do{l.push(new Kt.IntPoint(n.pt.x,n.pt.y));n=n.prev}while(n!=i.pts);o.holes.push(l);e++}t.push(o)}}};Kt.Clipper.prototype.FixupOutPolygon=function(t){var e=null;t.pts=t.bottomPt;for(var i=t.bottomPt;;){if(i.prev==i||i.prev==i.next){this.DisposeOutPts(i);t.pts=null;t.bottomPt=null;return}if(Kt.ClipperBase.PointsEqual(i.pt,i.next.pt)||this.SlopesEqual(i.prev.pt,i.pt,i.next.pt,this.m_UseFullRange)){e=null;i==t.bottomPt&&(t.bottomPt=null);i.prev.next=i.next;i.next.prev=i.prev;i=i.prev;null}else{if(i==e)break;null==e&&(e=i);i=i.next}}if(null==t.bottomPt){t.bottomPt=this.GetBottomPt(i);t.bottomPt.idx=t.idx;t.pts=t.bottomPt}};Kt.Clipper.prototype.JoinPoints=function(t,e,i){e.Value=null;i.Value=null;var n=this.m_PolyOuts[t.poly1Idx],r=this.m_PolyOuts[t.poly2Idx];if(null==n||null==r)return!1;var o=n.pts,s=r.pts,l=t.pt2a,p=t.pt2b,h=t.pt1a,a=t.pt1b;if(!function(){o={Value:o};l={Value:l};p={Value:p};var t=this.FindSegment(o,this.m_UseFullRange,l,p);o=o.Value;l=l.Value;p=p.Value;return t}.call(this))return!1;if(n==r){s=o.next;if(!function(){s={Value:s};h={Value:h};a={Value:a};var t=this.FindSegment(s,this.m_UseFullRange,h,a);s=s.Value;h=h.Value;a=a.Value;return t}.call(this)||s==o)return!1}else if(!function(){s={Value:s};h={Value:h};a={Value:a};var t=this.FindSegment(s,this.m_UseFullRange,h,a);s=s.Value;h=h.Value;a=a.Value;return t}.call(this))return!1;if(!function(){l={Value:l};p={Value:p};var t=this.GetOverlapSegment(l.Value,p.Value,h,a,l,p);l=l.Value;p=p.Value;return t}.call(this))return!1;var u,f,d=o.prev;Kt.ClipperBase.PointsEqual(o.pt,l)?e.Value=o:Kt.ClipperBase.PointsEqual(d.pt,l)?e.Value=d:e.Value=this.InsertPolyPtBetween(o,d,l);Kt.ClipperBase.PointsEqual(o.pt,p)?i.Value=o:Kt.ClipperBase.PointsEqual(d.pt,p)?i.Value=d:e.Value==o||e.Value==d?i.Value=this.InsertPolyPtBetween(o,d,p):this.Pt3IsBetweenPt1AndPt2(o.pt,e.Value.pt,p)?i.Value=this.InsertPolyPtBetween(o,e.Value,p):i.Value=this.InsertPolyPtBetween(e.Value,d,p);d=s.prev;u=Kt.ClipperBase.PointsEqual(s.pt,l)?s:Kt.ClipperBase.PointsEqual(d.pt,l)?d:this.InsertPolyPtBetween(s,d,l);f=Kt.ClipperBase.PointsEqual(s.pt,p)?s:Kt.ClipperBase.PointsEqual(d.pt,p)?d:u==s||u==d?this.InsertPolyPtBetween(s,d,p):this.Pt3IsBetweenPt1AndPt2(s.pt,u.pt,p)?this.InsertPolyPtBetween(s,u,p):this.InsertPolyPtBetween(u,d,p);if(e.Value.next==i.Value&&u.prev==f){e.Value.next=u;u.prev=e.Value;i.Value.prev=f;f.next=i.Value;return!0}if(e.Value.prev==i.Value&&u.next==f){e.Value.prev=u;u.next=e.Value;i.Value.next=f;f.prev=i.Value;return!0}return!1};Kt.Clipper.prototype.FixupJoinRecs=function(t,e,i){for(var n=i;n<this.m_Joins.length;n++){var r=this.m_Joins[n];r.poly1Idx==t.poly1Idx&&this.PointIsVertex(r.pt1a,e)&&(r.poly1Idx=t.poly2Idx);r.poly2Idx==t.poly1Idx&&this.PointIsVertex(r.pt2a,e)&&(r.poly2Idx=t.poly2Idx)}};Kt.Clipper.prototype.JoinCommonEdges=function(){for(var t,e,i=0;i<this.m_Joins.length;i++){var n,r,o=this.m_Joins[i];if(function(){n={Value:n};r={Value:r};var t=this.JoinPoints(o,n,r);n=n.Value;r=r.Value;return t}.call(this)){var s=this.m_PolyOuts[o.poly1Idx],l=this.m_PolyOuts[o.poly2Idx];if(s==l){s.pts=this.GetBottomPt(n);s.bottomPt=s.pts;s.bottomPt.idx=s.idx;l=this.CreateOutRec();this.m_PolyOuts.push(l);l.idx=this.m_PolyOuts.length-1;o.poly2Idx=l.idx;l.pts=this.GetBottomPt(r);l.bottomPt=l.pts;l.bottomPt.idx=l.idx;if(this.PointInPolygon(l.pts.pt,s.pts,this.m_UseFullRange)){l.isHole=!s.isHole;l.FirstLeft=s;this.FixupJoinRecs(o,r,i+1);this.FixupOutPolygon(s);this.FixupOutPolygon(l);(l.isHole^this.m_ReverseOutput)==this.Area(l,this.m_UseFullRange)>0&&this.ReversePolyPtLinks(l.pts)}else if(this.PointInPolygon(s.pts.pt,l.pts,this.m_UseFullRange)){l.isHole=s.isHole;s.isHole=!l.isHole;l.FirstLeft=s.FirstLeft;s.FirstLeft=l;this.FixupJoinRecs(o,r,i+1);this.FixupOutPolygon(s);this.FixupOutPolygon(l);(s.isHole^this.m_ReverseOutput)==this.Area(s,this.m_UseFullRange)>0&&this.ReversePolyPtLinks(s.pts);if(this.m_UsingExPolygons&&s.isHole)for(t=0;t<this.m_PolyOuts.length;++t){e=this.m_PolyOuts[t];e.isHole&&null!=e.bottomPt&&e.FirstLeft==s&&(e.FirstLeft=l)}}else{l.isHole=s.isHole;l.FirstLeft=s.FirstLeft;this.FixupJoinRecs(o,r,i+1);this.FixupOutPolygon(s);this.FixupOutPolygon(l);if(this.m_UsingExPolygons&&null!=l.pts)for(t=0;t<this.m_PolyOuts.length;++t){e=this.m_PolyOuts[t];e.isHole&&null!=e.bottomPt&&e.FirstLeft==s&&this.PointInPolygon(e.bottomPt.pt,l.pts,this.m_UseFullRange)&&(e.FirstLeft=l)}}}else{if(this.m_UsingExPolygons)for(t=0;t<this.m_PolyOuts.length;++t)this.m_PolyOuts[t].isHole&&null!=this.m_PolyOuts[t].bottomPt&&this.m_PolyOuts[t].FirstLeft==l&&(this.m_PolyOuts[t].FirstLeft=s);this.FixupOutPolygon(s);if(null!=s.pts){s.isHole=this.Area(s,this.m_UseFullRange)<0;s.isHole&&null==s.FirstLeft&&(s.FirstLeft=l.FirstLeft)}var p=s.idx,h=l.idx;l.pts=null;l.bottomPt=null;l.AppendLink=s;for(t=i+1;t<this.m_Joins.length;t++){var a=this.m_Joins[t];a.poly1Idx==h&&(a.poly1Idx=p);a.poly2Idx==h&&(a.poly2Idx=p)}}}}};Kt.Clipper.FullRangeNeeded=function(t){for(var e=!1,i=0;i<t.length;i++)Kt.Math_Abs_Int64(t[i].x)>Kt.ClipperBase.hiRange||Kt.Math_Abs_Int64(t[i].y)>Kt.ClipperBase.hiRange?Kt.Error("Coordinate exceeds range bounds in FullRangeNeeded()."):(Kt.Math_Abs_Int64(t[i].x)>Kt.ClipperBase.loRange||Kt.Math_Abs_Int64(t[i].y)>Kt.ClipperBase.loRange)&&(e=!0);return e};Kt.Clipper.prototype.Area=Kt.Clipper.Area=function(){var e,i,n=arguments;if(1==n.length){var r=n[0],o=r.length-1;if(o<2)return 0;if(Kt.Clipper.FullRangeNeeded(r)){i=new t(r[o].x+r[0].x).multiply(new t(r[0].y-r[o].y));for(e=1;e<=o;++e)i=i.add(new t(r[e-1].x+r[e].x).multiply(new t(r[e].y-r[e-1].y)));return parseFloat(i.toString())/2}var s=(r[o].x+r[0].x)*(r[0].y-r[o].y);for(e=1;e<=o;++e)s+=(r[e-1].x+r[e].x)*(r[e].y-r[e-1].y);return s/2}if(2==n.length){var l=n[0],p=n[1],h=l.pts;if(null==h)return 0;if(p){i=new t(t.ZERO);do{i=i.add(new t(h.pt.x+h.prev.pt.x).multiply(new t(h.prev.pt.y-h.pt.y)));h=h.next}while(h!=l.pts);return parseFloat(i.toString())/2}i=0;do{i+=(h.pt.x+h.prev.pt.x)*(h.prev.pt.y-h.pt.y);h=h.next}while(h!=l.pts);return i/2}};Kt.Clipper.BuildArc=function(t,e,i,n){var r=Math.sqrt(Kt.Math_Abs_Double(n))*Kt.Math_Abs_Double(i-e);r/=4;r<6&&(r=6);r>64&&(r=Kt.MaxSteps);for(var o=Kt.Cast_Int32(r),s=new Kt.Polygon,l=(i-e)/(o-1),p=e,h=0;h<o;++h){s.push(new Kt.IntPoint(t.x+Kt.Clipper.Round(Math.cos(p)*n),t.y+Kt.Clipper.Round(Math.sin(p)*n)));p+=l}return s};Kt.Clipper.GetUnitNormal=function(t,e){var i=e.x-t.x,n=e.y-t.y;if(0==i&&0==n)return new Kt.Clipper.DoublePoint(0,0);var r=1/Math.sqrt(i*i+n*n);i*=r;n*=r;return new Kt.Clipper.DoublePoint(n,-i)};Kt.Clipper.prototype.OffsetPolygons=function(t,e,i,n,r){var o=arguments;if(4==o.length)r=!0;else if(3==o.length){n=2;r=!0}else if(2==o.length){i=Kt.JoinType.jtSquare;n=2;r=!0}isNaN(e)?Kt.Error("Delta is not a number"):isNaN(n)&&Kt.Error("MiterLimit is not a number");var s={};new Kt.Clipper.PolyOffsetBuilder(t,s,e,i,n,r);s=s.Value?s.Value:[[]];return s};Kt.Clipper.prototype.SimplifyPolygon=function(t,e){var i=new Kt.Polygons,n=new Kt.Clipper;n.AddPolygon(t,Kt.PolyType.ptSubject)&&n.Execute(Kt.ClipType.ctUnion,i,e,e);return i};Kt.Clipper.prototype.SimplifyPolygons=function(t,e){var i=new Kt.Polygons,n=new Kt.Clipper;n.AddPolygons(t,Kt.PolyType.ptSubject)&&n.Execute(Kt.ClipType.ctUnion,i,e,e);return i};var ye,ce=Kt.Clipper,me=Kt.ClipperBase;if(void 0===Object.getOwnPropertyNames){for(ye in me.prototype)void 0!==ce.prototype[ye]&&ce.prototype[ye]!=Object.prototype[ye]||(ce.prototype[ye]=me.prototype[ye]);for(ye in me)void 0===ce[ye]&&(ce[ye]=me[ye]);ce.$baseCtor=me}else{for(var xe=Object.getOwnPropertyNames(me.prototype),ge=0;ge<xe.length;ge++)void 0===Object.getOwnPropertyDescriptor(ce.prototype,xe[ge])&&Object.defineProperty(ce.prototype,xe[ge],Object.getOwnPropertyDescriptor(me.prototype,xe[ge]));for(ye in me)void 0===ce[ye]&&(ce[ye]=me[ye]);ce.$baseCtor=me}Kt.Clipper.DoublePoint=function(t,e){this.x=t;this.y=e};Kt.Clipper.PolyOffsetBuilder=function(t,e,i,n,r,o){this.pts=null;this.currentPoly=null;this.normals=null;this.delta=0;this.m_R=0;this.m_i=0;this.m_j=0;this.m_k=0;this.botPt=null;if(0!=i){this.pts=t;this.delta=i;var s,l;if(o){for(var p=this.pts.length,h=0;h<p&&0==this.pts[h].length;)h++;if(h==p)return;this.botPt=this.pts[h][0];for(s=h;s<p;++s){this.UpdateBotPt(this.pts[s][0])&&(h=s);for(l=this.pts[s].length-1;l>0;l--)Kt.ClipperBase.PointsEqual(this.pts[s][l],this.pts[s][l-1])?this.pts[s].splice(l,1):this.UpdateBotPt(this.pts[s][l])&&(h=s)}Kt.Clipper.Orientation(this.pts[h])||Kt.Clipper.ReversePolygons(this.pts)}r<=1&&(r=1);var a=2/(r*r);this.normals=[];e.Value=new Kt.Polygons;var u;for(this.m_i=0;this.m_i<this.pts.length;this.m_i++){u=this.pts[this.m_i].length;u>1&&this.pts[this.m_i][0].x==this.pts[this.m_i][u-1].x&&this.pts[this.m_i][0].y==this.pts[this.m_i][u-1].y&&u--;if(!(0==u||u<3&&i<=0))if(1!=u){Kt.Clear(this.normals);for(l=0;l<u-1;++l)this.normals.push(Kt.Clipper.GetUnitNormal(this.pts[this.m_i][l],this.pts[this.m_i][l+1]));this.normals.push(Kt.Clipper.GetUnitNormal(this.pts[this.m_i][u-1],this.pts[this.m_i][0]));this.currentPoly=new Kt.Polygon;this.m_k=u-1;for(this.m_j=0;this.m_j<u;++this.m_j){switch(n){case Kt.JoinType.jtMiter:this.m_R=this.normals[this.m_j].x*this.normals[this.m_k].x+this.normals[this.m_j].y*this.normals[this.m_k].y+1;this.m_R>=a?this.DoMiter():this.DoSquare(r);break;case Kt.JoinType.jtRound:this.DoRound();break;case Kt.JoinType.jtSquare:this.DoSquare(1)}this.m_k=this.m_j}e.Value.push(this.currentPoly)}else{var f;f=Kt.Clipper.BuildArc(this.pts[this.m_i][u-1],0,Kt.PI2,i);e.Value.push(f)}}var d=new Kt.Clipper;d.AddPolygons(e.Value,Kt.PolyType.ptSubject);if(i>0)d.Execute(Kt.ClipType.ctUnion,e.Value,Kt.PolyFillType.pftPositive,Kt.PolyFillType.pftPositive);else{var y=d.GetBounds(),c=new Kt.Polygon;c.push(new Kt.IntPoint(y.left-10,y.bottom+10));c.push(new Kt.IntPoint(y.right+10,y.bottom+10));c.push(new Kt.IntPoint(y.right+10,y.top-10));c.push(new Kt.IntPoint(y.left-10,y.top-10));d.AddPolygon(c,Kt.PolyType.ptSubject);d.Execute(Kt.ClipType.ctUnion,e.Value,Kt.PolyFillType.pftNegative,Kt.PolyFillType.pftNegative);if(e.Value.length>0){e.Value.splice(0,1);for(s=0;s<e.Value.length;s++)e.Value[s].reverse()}}}else e.Value=t};Kt.Clipper.PolyOffsetBuilder.prototype.UpdateBotPt=function(t){if(t.y>this.botPt.y||t.y==this.botPt.y&&t.x<this.botPt.x){this.botPt=t;return!0}return!1};Kt.Clipper.PolyOffsetBuilder.prototype.AddPoint=function(t){this.currentPoly.push(t)};Kt.Clipper.PolyOffsetBuilder.prototype.DoSquare=function(t){var e=new Kt.IntPoint(Kt.Cast_Int64(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].x+this.normals[this.m_k].x*this.delta)),Kt.Cast_Int64(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].y+this.normals[this.m_k].y*this.delta))),i=new Kt.IntPoint(Kt.Cast_Int64(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].x+this.normals[this.m_j].x*this.delta)),Kt.Cast_Int64(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].y+this.normals[this.m_j].y*this.delta)));if((this.normals[this.m_k].x*this.normals[this.m_j].y-this.normals[this.m_j].x*this.normals[this.m_k].y)*this.delta>=0){var n=Math.atan2(this.normals[this.m_k].y,this.normals[this.m_k].x),r=Math.atan2(-this.normals[this.m_j].y,-this.normals[this.m_j].x);n=Math.abs(r-n);n>Kt.PI&&(n=Kt.PI2-n);var o=Math.tan((Kt.PI-n)/4)*Math.abs(this.delta*t);e=new Kt.IntPoint(Kt.Cast_Int64(e.x-this.normals[this.m_k].y*o),Kt.Cast_Int64(e.y+this.normals[this.m_k].x*o));this.AddPoint(e);i=new Kt.IntPoint(Kt.Cast_Int64(i.x+this.normals[this.m_j].y*o),Kt.Cast_Int64(i.y-this.normals[this.m_j].x*o));this.AddPoint(i)}else{this.AddPoint(e);this.AddPoint(this.pts[this.m_i][this.m_j]);this.AddPoint(i)}};Kt.Clipper.PolyOffsetBuilder.prototype.DoMiter=function(){if((this.normals[this.m_k].x*this.normals[this.m_j].y-this.normals[this.m_j].x*this.normals[this.m_k].y)*this.delta>=0){var t=this.delta/this.m_R;this.AddPoint(new Kt.IntPoint(Kt.Cast_Int64(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].x+(this.normals[this.m_k].x+this.normals[this.m_j].x)*t)),Kt.Cast_Int64(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].y+(this.normals[this.m_k].y+this.normals[this.m_j].y)*t))))}else{var e=new Kt.IntPoint(Kt.Cast_Int64(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].x+this.normals[this.m_k].x*this.delta)),Kt.Cast_Int64(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].y+this.normals[this.m_k].y*this.delta))),i=new Kt.IntPoint(Kt.Cast_Int64(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].x+this.normals[this.m_j].x*this.delta)),Kt.Cast_Int64(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].y+this.normals[this.m_j].y*this.delta)));this.AddPoint(e);this.AddPoint(this.pts[this.m_i][this.m_j]);this.AddPoint(i)}};Kt.Clipper.PolyOffsetBuilder.prototype.DoRound=function(){var t=new Kt.IntPoint(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].x+this.normals[this.m_k].x*this.delta),Kt.Clipper.Round(this.pts[this.m_i][this.m_j].y+this.normals[this.m_k].y*this.delta)),e=new Kt.IntPoint(Kt.Clipper.Round(this.pts[this.m_i][this.m_j].x+this.normals[this.m_j].x*this.delta),Kt.Clipper.Round(this.pts[this.m_i][this.m_j].y+this.normals[this.m_j].y*this.delta));this.AddPoint(t);if((this.normals[this.m_k].x*this.normals[this.m_j].y-this.normals[this.m_j].x*this.normals[this.m_k].y)*this.delta>=0){if(this.normals[this.m_j].x*this.normals[this.m_k].x+this.normals[this.m_j].y*this.normals[this.m_k].y<.985){var i=Math.atan2(this.normals[this.m_k].y,this.normals[this.m_k].x),n=Math.atan2(this.normals[this.m_j].y,this.normals[this.m_j].x);this.delta>0&&n<i?n+=Kt.PI2:this.delta<0&&n>i&&(n-=Kt.PI2);for(var r=Kt.Clipper.BuildArc(this.pts[this.m_i][this.m_j],i,n,this.delta),o=0;o<r.length;o++)this.AddPoint(r[o])}}else this.AddPoint(this.pts[this.m_i][this.m_j]);this.AddPoint(e)};Kt.Error=function(t){try{throw new Error(t)}catch(t){alert(t.message)}};Kt.Clone=function(t){if(!Array.isArray(t))return[];if(0==t.length)return[];if(1==t.length&&0==t[0].length)return[[]];var e=Array.isArray(t[0]);e||(t=[t]);var i,n,r,o,s=t.length,l=[];for(n=0;n<s;n++){i=t[n].length;o=[];for(r=0;r<i;r++)o.push({x:t[n][r].x,y:t[n][r].y});l.push(o)}e||(l=l[0]);return l};Kt.Clean=function(t,e){if(!Array.isArray(t))return[];var i=Array.isArray(t[0]),t=Kt.Clone(t);if("number"!=typeof e||null===e){Kt.Error("Delta is not a number in Clean().");return t}if(0==t.length||1==t.length&&0==t[0].length||e<0)return t;i||(t=[t]);for(var n,r,o,s,l,p,h,a=t.length,u=[],f=0;f<a;f++){r=t[f];n=r.length;if(0!=n)if(n<3){o=r;u.push(o)}else{o=r;s=e*e;l=r[0];p=1;for(h=1;h<n;h++)if(!((r[h].x-l.x)*(r[h].x-l.x)+(r[h].y-l.y)*(r[h].y-l.y)<=s)){o[p]=r[h];l=r[h];p++}l=r[p-1];(r[0].x-l.x)*(r[0].x-l.x)+(r[0].y-l.y)*(r[0].y-l.y)<=s&&p--;p<n&&o.splice(p,n-p);o.length&&u.push(o)}}!i&&u.length?u=u[0]:i||0!=u.length?i&&0==u.length&&(u=[[]]):u=[];return u};Kt.Lighten=function(t,e){if(!Array.isArray(t))return[];if("number"!=typeof e||null===e){Kt.Error("Tolerance is not a number in Lighten().");return Kt.Clone(t)}if(0===t.length||1==t.length&&0===t[0].length||e<0)return Kt.Clone(t);Array.isArray(t[0])||(t=[t]);var i,n,r,o,s,l,p,h,a,u,f,d,y,c,m,x=t.length,g=[];for(i=0;i<x;i++){r=t[i];for(o=0;o<1e6;o++){s=[];l=r.length;if(r[l-1].x!=r[0].x||r[l-1].y!=r[0].y){d=1;r.push({x:r[0].x,y:r[0].y});l=r.length}else d=0;f=[];for(n=0;n<l-2;n++){p=r[n];a=r[n+1];h=r[n+2];y=h.x-p.x;c=h.y-p.y;u=0;if(0!==y||0!==c){m=Math.sqrt(y*y+c*c);u=Math.abs((a.x-p.x)*c-(a.y-p.y)*y)/m}if(u<=e){f[n+1]=1;n++}}s.push({x:r[0].x,y:r[0].y});for(n=1;n<l-1;n++)f[n]||s.push({x:r[n].x,y:r[n].y});s.push({x:r[l-1].x,y:r[l-1].y});d&&r.pop();if(!f.length)break;r=s}l=s.length;s[l-1].x==s[0].x&&s[l-1].y==s[0].y&&s.pop();s.length>2&&g.push(s)}Array.isArray(t[0])||(g=g[0]);void 0===g&&(g=[[]]);return g};Kt.OffsetPoint=function(t,e){return Kt.OffsetPolyline([t],e)};Kt.OffsetPolyline=function(t,e,i){var n=new Kt.Polygon;t.forEach(function(t){n.push(t)});if(t.length>2)for(var r=t.length-2;r>0;r--)n.push(t[r]);return Kt.OffsetPolygon(n,e,i)};Kt.OffsetPolygon=function(t,e,i){var n=new Kt.Polygons;n.push(t);return(new Kt.Clipper).OffsetPolygons(n,e,void 0===i?Kt.JoinType.jtRound:i,100,!0)};Kt.BuildArc=Kt.Clipper.BuildArc}();RTreeMgr.init=function(t){RTreeMgr.clear();DRCMgr.init();var e=[],i=[];for(var n in LAYERTYPE)if(own(LAYERTYPE,n)){var r=LAYERTYPE[n];if(r<=52&&r!==LAYERTYPE.RATLINES){e.push(r);isSignalLayer(r)&&i.push(r)}}e.forEach(function(t){RTreeMgr.layers.push(t);RTreeMgr.trees[t]=rbush(9);RTreeMgr._bulkPatch[t]=[]});i.forEach(function(t){RTreeMgr.signalLayers.push(t)});doctype!==DOCTYPE.PCBLIB&&(DRCMgr.maxClearance=jsonMgr.gJsonCache.DRCRULE.Default.clearance)};RTreeMgr.points2bbCoordinates=function(t,e){var i,n,r,o,s;e=e||0;for(var l=0;l<t.length;l++){s=t[l];if(i||n||r||o){+s.x<i&&(i=+s.x);+s.y<n&&(n=+s.y);+s.x>r&&(r=+s.x);+s.y>o&&(o=+s.y)}else{i=+s.x;n=+s.y;r=+s.x;o=+s.y}}return{minX:i-e,minY:n-e,maxX:r+e,maxY:o+e}};RTreeMgr.bbox2bbCoordinates=function(t,e){e=e||0;return{minX:t.x-e,minY:t.y-e,maxX:t.x+t.width+e,maxY:t.y+t.height+e}};RTreeMgr.line2bbCoordinates=function(t,e,i,n){var r=(n||DRCMgr.maxClearance)+i/2;r=r||0;return{minX:Math.min(t.x,e.x)-r,minY:Math.min(t.y,e.y)-r,maxX:Math.max(t.x,e.x)+r,maxY:Math.max(t.y,e.y)+r}};RTreeMgr.createNode=function(t,e){var i,n,r,o,s,l,p,h,a,u,f=[];if(doctype!==DOCTYPE.PCBLIB)var d=+jsonMgr.gJsonCache.DRCRULE.itemBoardOutlineClearance;if("TRACK"==e)for(i=0,n=t.pointArr.length;i<n-1;i++){r=RTreeMgr.line2bbCoordinates(t.pointArr[i],t.pointArr[i+1],t.strokeWidth,isSignalLayer(t.layerid)?getNetRule(t.net).clearance:t.layerid==LAYERTYPE.BOARDOUTLINE?d:d/2);l={gId:t.gId,layerid:t.layerid,net:t.net,pointArr:[t.pointArr[i],t.pointArr[i+1]],strokeWidth:t.strokeWidth};f[i]=r;f[i].type=e;f[i].node=l}else if("CIRCLE"==e){if(!$$(t.gId))return!1;h={x:utils.formatLengthSave(t.cx-t.r-Number(t.strokeWidth)/2),y:utils.formatLengthSave(t.cy-t.r-Number(t.strokeWidth)/2),width:utils.formatLengthSave(2*t.r+Number(t.strokeWidth)),height:utils.formatLengthSave(2*t.r+Number(t.strokeWidth))};f[0]=RTreeMgr.bbox2bbCoordinates(h,a);f[0].type=e;f[0].node=t;h={x:utils.formatLengthSave(t.cx-t.strokeWidth/2),y:utils.formatLengthSave(t.cy-t.strokeWidth/2),width:utils.formatLengthSave(t.strokeWidth),height:utils.formatLengthSave(t.strokeWidth)};f[1]=RTreeMgr.bbox2bbCoordinates(h,a);f[1].type="DOT";f[1].node={x:utils.formatLengthSave(t.cx),y:utils.formatLengthSave(t.cy),gId:t.gId,net:t.net,strokeWidth:t.strokeWidth}}else if("DIMENSION"==e||"PROTRACTOR"==e&&d){s=RTreeMgr._pathConvexHullPoints(t.d||t.pathStr);s.push(s[0]);for(i=0,n=s.length;i<n-1;i++){r=RTreeMgr.line2bbCoordinates(s[i],s[i+1],0,d/2);l={gId:t.gId,layerid:t.layerid,net:"",pointArr:[s[i],s[i+1]],strokeWidth:t.strokeWidth||0};f[i]=r;f[i].type=e;f[i].node=l}}else if("TEXT"==e){a=Math.max(getNetRule(t.net).clearance,t.strokeWidth||0);u=t.pathStr?t.pathStr.split("M"):[];u=u.filter(function(t){return""!==t.trim()});for(i=0;i<u.length;i++){s=RTreeMgr._pathConvexHullPoints("M"+u[i]);s.push(s[0]);h=RTreeMgr.points2bbCoordinates(s,a);l={gId:t.gId,layerid:t.layerid,net:t.net,pointArr:s,strokeWidth:t.strokeWidth||0,shape:"POLYGON",x:(h.minX+h.maxX)/2,y:(h.minY+h.maxY)/2};f[i]=h;f[i].type=e;f[i].node=l}}else if("SVGNODE"==e){if(t.attrs&&t.attrs.d){s=RTreeMgr._pathConvexHullPoints(t.attrs.d);if(s.length)for(i=0,n=s.length-1;i<n;i++){r=RTreeMgr.line2bbCoordinates(s[i],s[i+1],0,getNetRule("Default").clearance);l={gId:t.gId,layerid:t.layerid,net:"",pointArr:[s[i],s[i+1]],strokeWidth:0};f[i]=r;f[i].type=e;f[i].node=l}}}else if("RECT"==e){h={x:t.x,y:t.y,width:t.width,height:t.height};f[0]=RTreeMgr.bbox2bbCoordinates(h,getNetRule("Default").clearance);f[0].type=e;f[0].node=utils.extend({},t,{shape:"RECT",net:"",pointArr:[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height},{x:t.x,y:t.y}]})}else if("HOLE"==e){h={x:t.x-t.holeR,y:t.y-t.holeR,width:2*t.holeR,height:2*t.holeR};f[0]=RTreeMgr.bbox2bbCoordinates(h,getNetRule("Default").clearance);f[0].type=e;f[0].node=t}else if("VIA"==e){h={x:t.x-t.diameter/2,y:t.y-t.diameter/2,width:t.diameter,height:t.diameter};f[0]=RTreeMgr.bbox2bbCoordinates(h,getNetRule(t.net||"Default").clearance);f[0].type=e;f[0].node=t}else if("COPPERAREA"==e||"PLANEZONE"==e){a=getNetRule(t.net).clearance;void 0!==t.clearanceWidth&&(a=Math.max(t.clearanceWidth,a));var y=$$$("path[attachedcopperid="+t.gId+"]");if(!y.length&&t.fillData){var c=parseJSON(t.fillData);Array.isArray(c)&&(c=c[0]);for(i=0;i<c.length;i++)y[i]={d:c[i]}}t.trackArr=null;t.polygonArr=null;y.length&&y.forEach(function(i,n){var r,o,s,p,h,u,d,y,c=[],m=[],x=attr(i,"d");if(x&&"null"!=x){if(+attr(i,"stroke-width")){o=parseSVGPathData(x);Array.isArray(t.trackArr)?t.trackArr.push(o):t.trackArr=[o];for(s=0;s<o.length;s++){d=f.length;h=o[s];u=h[0];switch(u){case"M":p={x:+h[1],y:+h[2]};break;case"L":l={gId:t.gId,layerid:t.layerid,net:t.net,pointArr:[p,{x:+h[1],y:+h[2]}],strokeWidth:+t.strokeWidth,clearanceWidth:+t.clearanceWidth,copperAreaId:n};f[d]=RTreeMgr.line2bbCoordinates(p,{x:+h[1],y:+h[2]},+t.strokeWidth,a);f[d].type=e;f[d].node=l;p={x:+h[1],y:+h[2]};break;case"A":l={gId:t.gId,layerid:t.layerid,net:t.net,strokeWidth:+t.strokeWidth,clearanceWidth:+t.clearanceWidth,copperAreaId:n,arcParams:[p.x,p.y].concat(h.slice(1)),centerParam:utils.arc.getCenterParam(p.x,p.y,+h[6],+h[7],+h[4],+h[5],+h[1],+h[2],+h[3])};f[d]=RTreeMgr.bbox2bbCoordinates({x:l.centerParam.cx-h[1],y:l.centerParam.cy-h[2],width:2*Number(h[1]),height:2*Number(h[2])},a);f[d].type=e;f[d].node=l;p={x:+h[6],y:+h[7]}}}}else{r=pathToPolygons(x);for(s in r)own(r,s)&&"hole"!==s&&m.push(r[s]);c.push(m);r&&r.hole&&r.hole.forEach(function(t,e){c.push(t)});y=RTreeMgr.splitPolygon(c);for(s=0;s<y.length;s++){l={gId:t.gId,layerid:t.layerid,net:t.net,polygonArr:[[y[s]]],clearanceWidth:t.clearanceWidth,copperAreaId:n};y[s].holes&&(l.polygonArr[0]=l.polygonArr[0].concat(y[s].holes));d=f.length;f[d]=RTreeMgr.points2bbCoordinates(y[s],a);f[d].type=e;f[d].node=l}Array.isArray(t.polygonArr)?t.polygonArr.push(c):t.polygonArr=[c]}}})}else if("SOLIDREGION"==e){t.pointArr=pathToPolygons(t.pathStr);f[0]=RTreeMgr.points2bbCoordinates(t.pointArr,a);f[0].type=e;f[0].node=t}else if("ARC"==e){if(!$$(t.gId))return!1;o=t.d.match(/([-+]?\d+(\.\d+)?)/g);t.arcParams=o;t.centerParam=utils.arc.getCenterParam(+o[0],+o[1],+o[7],+o[8],+o[5],+o[6],+o[2],+o[3],+o[4]);t.pointArr||(t.pointArr=convertArcToTrackPoints(t,!1));h={x:utils.formatLengthSave(t.centerParam.cx-t.centerParam.rx-t.strokeWidth/2),y:utils.formatLengthSave(t.centerParam.cy-t.centerParam.ry-t.strokeWidth/2),width:utils.formatLengthSave(2*t.centerParam.rx+t.strokeWidth),height:utils.formatLengthSave(2*t.centerParam.ry+t.strokeWidth)};f[0]=RTreeMgr.bbox2bbCoordinates(h,a);f[0].type=e;f[0].node=t;h={x:utils.formatLengthSave(t.centerParam.cx-t.strokeWidth/2),y:utils.formatLengthSave(t.centerParam.cy-t.strokeWidth/2),width:utils.formatLengthSave(t.strokeWidth),height:utils.formatLengthSave(t.strokeWidth)};f[1]=RTreeMgr.bbox2bbCoordinates(h,a);f[1].type="DOT";f[1].node={x:utils.formatLengthSave(t.centerParam.cx),y:utils.formatLengthSave(t.centerParam.cy),gId:t.gId,net:t.net,strokeWidth:t.strokeWidth}}else if("PAD"==e){a=getNetRule(t.net).clearance;switch(t.shape){case"OVAL":f[0]=RTreeMgr.line2bbCoordinates(t.pointArr2[0],t.pointArr2[1],Math.min(t.width,t.height),a);f[0].type=e;f[0].node=t;break;case"ELLIPSE":h={x:utils.formatLengthSave(t.x-t.width/2),y:utils.formatLengthSave(t.y-t.height/2),width:utils.formatLengthSave(t.width),height:utils.formatLengthSave(t.height)};f[0]=RTreeMgr.bbox2bbCoordinates(h,a);f[0].type=e;f[0].node=t;break;case"RECT":case"POLYGON":f[0]=RTreeMgr.points2bbCoordinates(t.pointArr,a);f[0].type=e;f[0].node=t;break;default:return!1}}else{p=$$(t.gId);if(!p)return!1;a=getNetRule(t.net).clearance;h=utils.svg.getBBox(p);f[0]=RTreeMgr.bbox2bbCoordinates(h,a);f[0].type=e;f[0].node=t}return!!f.length&&{layerid:t.layerid,treeNodes:f}};RTreeMgr._pathConvexHullPoints=function(t){var e,i,n,r,o,s,l,p,h=function(t){var e,i,n,r,o,s,l,p,h,a,u={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},f={m:"l",M:"L"},d=/([MZLHVCSQTAmzlhvcsqta])([eE ,\-\+.\d]+)*/g,y=t.match(d),c=[];for(e=0;e<y.length;e++){i=d.exec(t);if(Array.isArray(i)&&3===i.length&&i[2]&&i[2].trim()){o=i[2].match(/(?:[-+]?(?:(?:\d+\.\d+)|(?:(?:\d+)|(?:\.\d+)))(?:e[-+]?\d+)?)/gi);l=i[1].toLowerCase();if(u[l]&&(p=u[l])&&o.length>p){h=f[i[1]]?f[i[1]]:i[1];a=i[1];for(n=0,r=o.length;n<r;n+=p){s=o.slice(n,p);s.unshift(a);c.push(s);a=h}}else{o.unshift(i[1]);c.push(o)}}else{o=[i[1]];"z"==o[0]&&(o[0]="Z");c.push(o)}}return c}(t),a=new ConvexHullGrahamScan;for(e=0;e<h.length;e++){n=h[e];switch(n[0]){case"M":case"L":a.addPoint(n[1],n[2]);break;case"C":a.addPoint(n[5],n[6]);break;case"Q":a.addPoint(n[3],n[4]);break;case"A":r=h[e-1];if("M"==r[0]||"L"==r[0]){o=r[1];s=r[2]}else if("C"==r[0]){o=r[5];s=r[6]}else if("Q"==r[0]){o=r[3];s=r[4]}else if("A"==r[0]){o=r[6];s=r[7]}l={d:"M"+o+","+s+" A"+n[1]+","+n[2]+" "+n[3]+" "+n[4]+" "+n[5]+" "+n[6]+","+n[7]};p=convertArcToTrackPoints(l,!1);for(i=0;i<p.length;i++)a.addPoint(p[i].x,p[i].y)}}var u=a.getHull();return u<3?null:u};RTreeMgr._cacheToNodeIndex=function(t,e){RTreeMgr.nodeIndex[t]=e};RTreeMgr.insertNode=function(t,e){function i(t,e){RTreeMgr._isBulkMode?RTreeMgr._bulkPatch[t]=(RTreeMgr._bulkPatch[t]||[]).concat(e):RTreeMgr.trees[t]&&RTreeMgr.trees[t].load(e)}RTreeMgr.removeNode(t);if("SOLIDREGION"==e&&("cutout"==t.type||"npth"==t.type))return!1;var n=RTreeMgr.createNode(t,e),r=n.treeNodes;if(!n||!r)return!1;if(n&&n.treeNodes.length){RTreeMgr._cacheToNodeIndex(t.gId,n);n.layerid==LAYERTYPE.ALL?RTreeMgr.layers.filter(function(t){return isSignalLayer(t)}).forEach(function(t){i(t,r)}):i(n.layerid,r)}};RTreeMgr.insertNodes=function(t,e){if(Array.isArray(t))t.forEach(function(t){RTreeMgr.insertNode(t,e)});else for(var i in t)own(t,i)&&RTreeMgr.insertNode(t[i],e)};RTreeMgr.removeNode=function(t){function e(t,e){t.forEach(function(t){RTreeMgr.trees[e]&&RTreeMgr.trees[e].remove(t)})}if(t&&own(RTreeMgr.nodeIndex,t.gId)){var i=RTreeMgr.nodeIndex[t.gId],n=i.treeNodes;i.layerid==LAYERTYPE.ALL?RTreeMgr.layers.forEach(function(t){e(n,t)}):e(n,i.layerid);delete RTreeMgr.nodeIndex[t.gId];return!0}return!1};RTreeMgr.removeNodes=function(t){if(Array.isArray(t))t.forEach(function(t){RTreeMgr.removeNode(t)});else for(var e in t)own(t,e)&&RTreeMgr.removeNode(t[e])};RTreeMgr.clear=function(){RTreeMgr.nodeIndex={};RTreeMgr.trees={};RTreeMgr.signalLayers=[];RTreeMgr.layers=[];RTreeMgr._bulkPatch={};RTreeMgr._isBulkMode=!1};RTreeMgr.searchByPoint=function(t,e){var i={minX:t.x-t.r,minY:t.y-t.r,maxX:t.x+t.r,maxY:t.y+t.r}
;return RTreeMgr.trees[e]?RTreeMgr.trees[e].search(i):[]};RTreeMgr.searchByPoint2=function(t,e,i,n){var r={minX:t-i,minY:e-i,maxX:t+i,maxY:e+i};return RTreeMgr.trees[n]?RTreeMgr.trees[n].search(r):[]};RTreeMgr.rebuild=function(){RTreeMgr.init();RTreeMgr._isBulkMode=!0;for(var t=0,e=DRCMgr.checkedKeys.length;t<e;t++)for(var i in jsonMgr.gJsonCache[DRCMgr.checkedKeys[t]])own(jsonMgr.gJsonCache[DRCMgr.checkedKeys[t]],i)&&RTreeMgr.addToRTree(jsonMgr.gJsonCache[DRCMgr.checkedKeys[t]][i],DRCMgr.checkedKeys[t]);RTreeMgr.allCircleToArc();RTreeMgr.layers.forEach(function(t){RTreeMgr.trees[t].load(RTreeMgr._bulkPatch[t])});RTreeMgr._isBulkMode=!1};RTreeMgr.addToRTree=function(t,e){t&&("FOOTPRINT"==e?DRCMgr.checkedKeys.forEach(function(e){RTreeMgr.insertNodes(t[e],e)}):RTreeMgr.insertNode(t,e))};RTreeMgr.removeFromRTree=function(t,e){t&&("FOOTPRINT"==e?DRCMgr.checkedKeys.forEach(function(e){RTreeMgr.removeNodes(t[e])}):RTreeMgr.removeNode(t))};RTreeMgr.circleToArc=function(t){var e,i;RTreeMgr.nodeIndex;e=t.type;i=t.node;if("CIRCLE"===e&&i){var n=+i.cx,r=+i.cy,o=+i.r,s=n-o,l=r+.01,p="M"+s+","+r+" A"+o+","+o+" 0 1 1 "+s+","+l,h={d:p,"stroke-width":i.strokeWidth,fill:"none",c_shapetype:"line",layerid:i.layerid,id:i.gId,net:i.net,c_auto_net:i.c_auto_net||null},a=createSVGElement("path",h),u=getCmdKey(a),f=SVG2Obj[u](a),d={},y=[],c=utils.svg.getBBox(a),m=getNetRule(f.net).clearance,x=f.d.match(/([-+]?\d+(\.\d+)?)/g);d.layerid=i.layerid;y[0]=RTreeMgr.bbox2bbCoordinates(c,m);y[0].type=u;f.isCircle=!0;f.arcParams=x;f.pointArr=convertArcToTrackPoints(a,!1);f.centerParam=utils.arc.getCenterParam(+x[0],+x[1],+x[7],+x[8],+x[5],+x[6],+x[2],+x[3],+x[4]);y[0].node=f;d.treeNodes=y;RTreeMgr.nodeIndex[a.id]=d;RTreeMgr._bulkPatch[i.layerid]?RTreeMgr._bulkPatch[i.layerid].push(y[0]):RTreeMgr._bulkPatch[i.layerid]=y;RTreeMgr._bulkPatch[i.layerid]?RTreeMgr._bulkPatch[i.layerid].push(y[0]):RTreeMgr._bulkPatch[i.layerid]=y}};RTreeMgr.allCircleToArc=function(){var t,e,i=RTreeMgr.nodeIndex;for(var n in i)if(own(i,n)){t=i[n];e=t.treeNodes[0].type;t.treeNodes[0].node;"CIRCLE"===e&&RTreeMgr.circleToArc(t.treeNodes[0])}};RTreeMgr.splitPolygon=function(t){var e=function(t){for(var e,i,n,r,o,s=0;s<t.length;s++){o=t[s];if(e||i||n||r){+o.x<e&&(e=+o.x);+o.y<i&&(i=+o.y);+o.x>n&&(n=+o.x);+o.y>r&&(r=+o.y)}else{e=+o.x;i=+o.y;n=+o.x;r=+o.y}}return{minX:e,minY:i,maxX:n,maxY:r,width:n-e,height:r-i}}(t[0]);if(e.width<=25&&e.height<=25){if(t.length>1){t[0].holes=t.splice(1);return t}return t}var i=Math.ceil(e.width/25),n=Math.ceil(e.height/25),r=new ClipperLib.Polygons,o=new ClipperLib.ExPolygons,s=new ClipperLib.Clipper;for(l=0;l<t.length;l++)r.push(t[l].map(function(t){return{x:Math.round(500*t.x),y:Math.round(500*t.y)}}));s.AddPolygons(r,ClipperLib.PolyType.ptSubject);var l,p,h=new ClipperLib.Polygons;for(l=0;l<i;l+=2)h.push([{x:500*(e.minX+25*l),y:500*e.minY},{x:500*(e.minX+25*l+25),y:500*e.minY},{x:500*(e.minX+25*l+25),y:500*e.maxY},{x:500*(e.minX+25*l),y:500*e.maxY},{x:500*(e.minX+25*l),y:500*e.minY}]);s.AddPolygons(h,ClipperLib.PolyType.ptClip);s.Execute(ClipperLib.ClipType.ctIntersection,o,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero);var a,u,f=[],d=new ClipperLib.Polygons;for(l=0;l<o.length;l++){a=o[l].outer;a.push(a[0]);d.push(a);u=o[l].holes;for(p=0;p<u.length;p++){u[p].push(u[p][0]);d.push(u[p])}}h=new ClipperLib.Polygons;for(l=0;l<n;l+=2)h.push([{x:500*e.minX,y:500*(e.minY+25*l)},{x:500*e.maxX,y:500*(e.minY+25*l)},{x:500*e.maxX,y:500*(e.minY+25*l+25)},{x:500*e.minX,y:500*(e.minY+25*l+25)},{x:500*e.minX,y:500*(e.minY+25*l)}]);o=new ClipperLib.ExPolygons;s=new ClipperLib.Clipper;s.AddPolygons(d,ClipperLib.PolyType.ptSubject);s.AddPolygons(h,ClipperLib.PolyType.ptClip);s.Execute(ClipperLib.ClipType.ctIntersection,o,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero);for(l=0;l<o.length;l++){a=o[l].outer;a=a.map(function(t){return{x:t.x/500,y:t.y/500}});a.push(a[0]);f.push(a);u=o[l].holes;if(u.length){for(p=0;p<u.length;p++){u[p]=u[p].map(function(t){return{x:t.x/500,y:t.y/500}});u[p].push(u[p][0])}a.holes=u}}h=new ClipperLib.Polygons;for(l=1;l<n;l+=2)h.push([{x:500*e.minX,y:500*(e.minY+25*l)},{x:500*e.maxX,y:500*(e.minY+25*l)},{x:500*e.maxX,y:500*(e.minY+25*l+25)},{x:500*e.minX,y:500*(e.minY+25*l+25)},{x:500*e.minX,y:500*(e.minY+25*l)}]);o=new ClipperLib.ExPolygons;s=new ClipperLib.Clipper;s.AddPolygons(d,ClipperLib.PolyType.ptSubject);s.AddPolygons(h,ClipperLib.PolyType.ptClip);s.Execute(ClipperLib.ClipType.ctIntersection,o,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero);for(l=0;l<o.length;l++){a=o[l].outer;a=a.map(function(t){return{x:t.x/500,y:t.y/500}});a.push(a[0]);f.push(a);u=o[l].holes;if(u.length){for(p=0;p<u.length;p++){u[p]=u[p].map(function(t){return{x:t.x/500,y:t.y/500}});u[p].push(u[p][0])}a.holes=u}}d=new ClipperLib.Polygons;h=new ClipperLib.Polygons;for(l=1;l<i;l+=2)h.push([{x:500*(e.minX+25*l),y:500*e.minY},{x:500*(e.minX+25*l+25),y:500*e.minY},{x:500*(e.minX+25*l+25),y:500*e.maxY},{x:500*(e.minX+25*l),y:500*e.maxY},{x:500*(e.minX+25*l),y:500*e.minY}]);o=new ClipperLib.ExPolygons;s=new ClipperLib.Clipper;s.AddPolygons(r,ClipperLib.PolyType.ptSubject);s.AddPolygons(h,ClipperLib.PolyType.ptClip);s.Execute(ClipperLib.ClipType.ctIntersection,o,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero);for(l=0;l<o.length;l++){a=o[l].outer;a.push(a[0]);d.push(a);u=o[l].holes;for(p=0;p<u.length;p++){u[p].push(u[p][0]);d.push(u[p])}}h=new ClipperLib.Polygons;for(l=0;l<n;l+=2)h.push([{x:500*e.minX,y:500*(e.minY+25*l)},{x:500*e.maxX,y:500*(e.minY+25*l)},{x:500*e.maxX,y:500*(e.minY+25*l+25)},{x:500*e.minX,y:500*(e.minY+25*l+25)},{x:500*e.minX,y:500*(e.minY+25*l)}]);o=new ClipperLib.ExPolygons;s=new ClipperLib.Clipper;s.AddPolygons(d,ClipperLib.PolyType.ptSubject);s.AddPolygons(h,ClipperLib.PolyType.ptClip);s.Execute(ClipperLib.ClipType.ctIntersection,o,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero);for(l=0;l<o.length;l++){a=o[l].outer;a=a.map(function(t){return{x:t.x/500,y:t.y/500}});a.push(a[0]);f.push(a);u=o[l].holes;if(u.length){for(p=0;p<u.length;p++){u[p]=u[p].map(function(t){return{x:t.x/500,y:t.y/500}});u[p].push(u[p][0])}a.holes=u}}h=new ClipperLib.Polygons;for(l=1;l<n;l+=2)h.push([{x:500*e.minX,y:500*(e.minY+25*l)},{x:500*e.maxX,y:500*(e.minY+25*l)},{x:500*e.maxX,y:500*(e.minY+25*l+25)},{x:500*e.minX,y:500*(e.minY+25*l+25)},{x:500*e.minX,y:500*(e.minY+25*l)}]);o=new ClipperLib.ExPolygons;s=new ClipperLib.Clipper;s.AddPolygons(d,ClipperLib.PolyType.ptSubject);s.AddPolygons(h,ClipperLib.PolyType.ptClip);s.Execute(ClipperLib.ClipType.ctIntersection,o,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero);for(l=0;l<o.length;l++){a=o[l].outer;a=a.map(function(t){return{x:t.x/500,y:t.y/500}});a.push(a[0]);f.push(a);u=o[l].holes;if(u.length){for(p=0;p<u.length;p++){u[p]=u[p].map(function(t){return{x:t.x/500,y:t.y/500}});u[p].push(u[p][0])}a.holes=u}}return f};
//# sourceMappingURL=pcb.rtreeMgrWorker.dependence.min.map